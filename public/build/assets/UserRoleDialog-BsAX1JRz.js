import{r as x,j as r,a as F}from"./currencyStore-Dk9RVyyc.js";import{S as h}from"./sweetalert2.esm.all-q958Q1qq.js";import{D as S,a as y}from"./DialogContent-Cz4a0t2H.js";import{D}from"./DialogTitle-osZsMdGC.js";import{f as b,T as v}from"./TextField-DpXyhoD7.js";import{c as G}from"./clsx-B-dksMZM.js";import{g as P,b as R,u as U,s as M,c as B}from"./memoTheme-BxRvtGIq.js";import{u as E}from"./useFormControl-Cowmrh0y.js";import{G as g}from"./Grid-6qcTmjc4.js";import{F as T}from"./FormControlLabel-eGygXIaI.js";import{S as W}from"./Switch-DzXzblLj.js";import{D as k}from"./DialogActions-BraO_KzF.js";import{B as j}from"./Button-aMjmD1gp.js";import"./useTheme-CvovRv7W.js";import"./useSlot-PFdYD2CN.js";import"./useForkRef-DgOCCfFR.js";import"./Paper-Df0ljdBt.js";import"./Modal-D1QunwiJ.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./useId-9XzpHYrc.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./extendSxProp-Co6nc6xJ.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./debounce-Be36O1Ab.js";import"./index-DM5RHFVd.js";import"./useSlotProps-DuznN7Ax.js";import"./Grow-D31e1sMI.js";import"./useTimeout--F2UA0HV.js";import"./mergeSlotProps-D_PRovB-.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./useControlled-DRAJCB75.js";import"./createSvgIcon-B7q9zImx.js";import"./isMuiElement-HmfyYHhb.js";import"./index-Rj29YxKv.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./SwitchBase-DLVdjlNh.js";import"./ButtonBase-CjVOrSoJ.js";import"./CircularProgress-B97ut0O7.js";function q(n){return P("MuiFormGroup",n)}R("MuiFormGroup",["root","row","error"]);const A=n=>{const{classes:t,row:s,error:e}=n;return B({root:["root",s&&"row",e&&"error"]},q,t)},N=M("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),_=x.forwardRef(function(t,s){const e=U({props:t,name:"MuiFormGroup"}),{className:a,row:c=!1,...u}=e,d=E(),f=b({props:e,muiFormControl:d,states:["error"]}),l={...e,row:c,error:f.error},o=A(l);return r.jsx(N,{className:G(o.root,a),ownerState:l,ref:s,...u})});function Er({open:n,handleClose:t,user_role:s}){const[e,a]=x.useState({user_role:"",permissions:[]}),c=["pos","products","inventory","sales","customers","vendors","charges","collections","expenses","quotations","reloads","cheques","sold-items","purchases","payments","stores","employees","payroll","media","settings"];x.useEffect(()=>{a(s?{user_role:s.name||"",permissions:s.permissions?.map(o=>o.name)||[]}:{user_role:"",permissions:[]})},[s]);const u=o=>{const{name:m,value:p}=o.target;a(i=>({...i,[m]:p}))},d=o=>{const{value:m,checked:p}=o.target;a(i=>{const w=p?[...i.permissions,m]:i.permissions.filter(C=>C!==m);return{...i,permissions:w}})},f=o=>{o.preventDefault();const m=s?`/user/${s.id}/role`:"/user/role";F.post(m,e,{onSuccess:p=>{const i=p.props.flash?.message||"User role and permissions updated!";h.fire({title:"Success!",text:i,icon:"success",position:"bottom-start",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,toast:!0}),t()},onError:p=>{const i=Object.values(p).flat().join(" | ");h.fire({title:"Error!",text:i||"An unexpected error occurred.",icon:"error",confirmButtonText:"OK",timerProgressBar:!0})}})},l=window.innerWidth<768;return r.jsxs(S,{open:n,onClose:t,maxWidth:"sm",fullWidth:!0,PaperProps:{component:"form",onSubmit:f},fullScreen:l,children:[r.jsx(D,{children:"User Role and Permissions"}),r.jsxs(y,{children:[r.jsx(v,{className:"py-8",required:!0,margin:"dense",id:"user_role",name:"user_role",label:"User Role",type:"text",fullWidth:!0,variant:"outlined",value:e.user_role,onChange:u,disabled:e.user_role==="admin"||e.user_role==="super-admin"}),r.jsxs(_,{sx:{mt:"1rem"},children:[r.jsx("h4",{children:"Permissions"}),r.jsx(g,{container:!0,spacing:2,children:c.map((o,m)=>r.jsx(g,{size:{xs:6,sm:4},children:r.jsx(T,{sx:{textTransform:"capitalize"},control:r.jsx(W,{checked:e.permissions.includes(o),onChange:d,value:o,name:"permissions"}),label:o})},m))})]})]}),r.jsxs(k,{children:[r.jsx(j,{onClick:t,children:"Cancel"}),r.jsx(j,{type:"submit",children:"SAVE"})]})]})}export{Er as default};
