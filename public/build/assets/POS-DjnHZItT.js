import{r as o,a as K,j as r,H as Q,L as U}from"./currencyStore-Dk9RVyyc.js";import{W as X,F as Z,C as rr}from"./folder-open-CJR3uNFI.js";import{H as M,B as tr}from"./Home-BKek3M8v.js";import or from"./ProductItem-DFhWtQ66.js";import er from"./CartItem-B8SKpuOs.js";import ir from"./CartSummary-QfINlGJ5.js";import sr from"./CartFooter-DyesdwS7.js";import nr from"./SearchBox-Cryl8Lhl.js";import mr from"./CartIcon-C3PrMEQT.js";import{S as pr}from"./SalesContext-CG9t8_rq.js";import O from"./CartItemsTop-CRN_49uT.js";import ar from"./POSBottomBar-m-WGegE_.js";import lr from"./SaleTemplateItems-DxHqMj3A.js";import P from"./CollectionItem-CwGUPfUb.js";import{S as cr}from"./sweetalert2.esm.all-q958Q1qq.js";import{B as e}from"./Box-j1BTqM2v.js";import{C as dr}from"./CssBaseline-DBisayGl.js";import{A as xr}from"./AppBar-CxLpgr4B.js";import{T as F}from"./Toolbar-f3-_dlD0.js";import{I as c}from"./IconButton-PbvyX_sG.js";import{T as b}from"./Typography-DOI0NvTt.js";import{G as i}from"./Grid-6qcTmjc4.js";import{L as E}from"./Link-2ACJKGF0.js";import{F as fr}from"./LocalOffer-RDrMQxbC.js";import{D as y}from"./Divider-D4ysiqwk.js";import{D as H}from"./Drawer-Dk2A_cxp.js";import{s as W}from"./memoTheme-BxRvtGIq.js";import"./createSvgIcon-B7q9zImx.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-BMpC51dL.js";import"./ButtonBase-CjVOrSoJ.js";import"./useTimeout--F2UA0HV.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./useForkRef-DgOCCfFR.js";import"./useSlotProps-DuznN7Ax.js";import"./useSlot-PFdYD2CN.js";import"./product-placeholder-DL4NWfZp.js";import"./currencyFormatter-Be2b0Ktm.js";import"./numeral-NHlY-3dw.js";import"./Card-C4NAxgST.js";import"./Paper-Df0ljdBt.js";import"./useTheme-CvovRv7W.js";import"./CardMedia-lO_mnymB.js";import"./CardContent-CCQfyhgH.js";import"./Delete-DDMcR4JX.js";import"./QuantityInput-Lj7juzBE.js";import"./Add-5ZpxTNJx.js";import"./Remove-6EDtWCFk.js";import"./CartItemModal-D80UqO0_.js";import"./Close-B9rgBTOR.js";import"./Visibility-BHSl7kaI.js";import"./VisibilityOff-CyahlUox.js";import"./Commission-TQHH1o-V.js";import"./TextField-DpXyhoD7.js";import"./useId-9XzpHYrc.js";import"./useFormControl-Cowmrh0y.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./index-CsFzvdgQ.js";import"./extendSxProp-Co6nc6xJ.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./debounce-Be36O1Ab.js";import"./index-DM5RHFVd.js";import"./Grow-D31e1sMI.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./mergeSlotProps-D_PRovB-.js";import"./Modal-D1QunwiJ.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./useControlled-DRAJCB75.js";import"./isMuiElement-HmfyYHhb.js";import"./InputAdornment-DZOHCUsF.js";import"./DialogContent-Cz4a0t2H.js";import"./DialogTitle-osZsMdGC.js";import"./Chip-DT462TV2.js";import"./Alert-CsOnCL1T.js";import"./Close-kFSrCAJM.js";import"./DialogActions-BraO_KzF.js";import"./Button-aMjmD1gp.js";import"./CircularProgress-B97ut0O7.js";import"./ListItem-BK8RisGy.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./ListItemAvatar-DpHqHrXm.js";import"./ListItemText--0XI93dL.js";import"./listItemTextClasses-DNpdtY9T.js";import"./MenuItem-CEIQJ6q4.js";import"./listItemIconClasses-vD-ryqxg.js";import"./dividerClasses-BJEnnqiu.js";import"./FolderCopy-VbOLkKr2.js";import"./ShoppingCart-C6ZMGsLy.js";import"./Receipt-DnWIM4Bg.js";import"./HeldItemsModal-pNNr8gAs.js";import"./ListItemButton-DDnSs3En.js";import"./PaymentsCheckoutDialog-0sdlSFZF.js";import"./PrintReceiptModal-Csw0Y3uy.js";import"./ReceiptDisplay-_SLXtf8O.js";import"./Print-5v-Lf9Qb.js";import"./snapdom-dxSfVsGw.js";import"./Barcode-DaGb-pRP.js";import"./JsBarcode-DwekVVut.js";import"./download-CxbKlL8J.js";import"./TableContainer-Bx1in-E2.js";import"./TableRow-BMfflATG.js";import"./TableCell-DMEjcBPA.js";import"./Percent-BCjtx-gP.js";import"./Payments-DSgOMdsa.js";import"./CreditCard-Dwl4hWaF.js";import"./HighlightOff-Bl6nUsD3.js";import"./index-RHigu7j0.js";import"./index-NgBaJJmW.js";import"./x-DFsc1drM.js";import"./FormControlLabel-eGygXIaI.js";import"./Checkbox-DmEdO0Ay.js";import"./SwitchBase-DLVdjlNh.js";import"./QuotationDialog-D91hlsyX.js";import"./CashCheckoutDialog-DdUAYNAL.js";import"./SaleTemplateDialog-QrpS1_42.js";import"./en-gb-BMmXCQZs.js";import"./index-JJ5bZ37u.js";import"./getThemeProps-DKKyYQML.js";import"./Search-BJKzt9AK.js";import"./lodash-CwOxCT-R.js";import"./Autocomplete-DfOnEm4b.js";import"./usePreviousProps-Dg0VAGfT.js";import"./Popper-pZx5Iht2.js";import"./Badge-DrYGhX8S.js";import"./Edit-ByvjS5ky.js";import"./MUITimePicker-BanoNu3u.js";import"./useMobilePicker-BIozrTWd.js";import"./index-P4sNTowN.js";import"./useThemeProps-Cgy5Iu59.js";import"./MobileTimePicker-CFR5bNoc.js";import"./Refresh-Be3nBego.js";import"./FormDialog-k2NLfBwH.js";import"./index-Rj29YxKv.js";import"./MUIDatePicker-uF2qI3Qp.js";import"./DatePicker--Uxs9Qj-.js";import"./Tooltip-DjVJzg5-.js";import"./Tabs-D51qE-ff.js";import"./KeyboardArrowRight-C0as7Qna.js";const p=530,hr=W("div")(({theme:s})=>({display:"flex",alignItems:"center",padding:s.spacing(0,1),...s.mixins.toolbar,justifyContent:"flex-end"})),jr=W("div")(({theme:s})=>({display:"flex",flexDirection:"column",alignItems:"center",padding:0,zIndex:"999"}));function Xo({products:s,customers:S,return_sale:w,categories:L,edit_sale:I,sale_data:V,default_charges:G,all_collections:d}){const a=I?"sale_edit_cart":w?"sales_return_cart":"sales_cart",[v,D]=o.useState(!1),[A,_]=o.useState(!1),[$,x]=o.useState(s),[J,f]=o.useState([]),[k,z]=o.useState("products"),[n,h]=o.useState(null),[j,l]=o.useState([]),[u,N]=o.useState(0),T=()=>{_(!0),D(!1)},R=()=>{_(!1)},Y=()=>{A||D(!v)};o.useEffect(()=>{a==="sales_return_cart"&&localStorage.setItem("sales_return_cart",JSON.stringify([])),a==="sale_edit_cart"&&localStorage.setItem("sale_edit_cart",JSON.stringify([]))},[a]),o.useEffect(()=>{I&&!V.cart_snapshot&&cr.fire({title:"Only recent sales can be edited",text:"Please select a recent sale to edit",icon:"error",confirmButtonText:"Go to Sales",showCancelButton:!1,showCloseButton:!1,allowOutsideClick:!1}).then(()=>{K.get("/sales")})});const g=async t=>{try{const m={collection_id:t.id},C=await axios.post("/pos/filter",m);x(C.data),f([]),h(t),t.children&&t.children.length>0?l(t.children):l([]),z("products")}catch(m){console.error("Error fetching products for collection:",m)}},q=t=>{z(t),(t==="products"||t==="collections")&&(h(null),l([]))},B=r.jsx(r.Fragment,{children:r.jsxs(e,{component:"form",action:"/pos",method:"post",sx:{display:"flex",flexDirection:"column",height:"100%",p:2,pb:0},children:[r.jsxs(e,{sx:{display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[r.jsx(e,{sx:{display:{xs:"none",sm:"block"}},children:r.jsx(O,{customers:S})}),r.jsx(y,{}),r.jsxs(e,{sx:{flex:1,overflow:"auto",pr:1},children:[r.jsx(er,{}),r.jsx(ir,{})]})]}),r.jsx(jr,{sx:{flexShrink:0,mt:2},children:r.jsx(sr,{})})]})});return r.jsxs(pr,{cartType:a,defaultCharges:G,children:[r.jsx(Q,{title:"Point of Sale"}),r.jsxs(e,{sx:{display:"flex"},children:[r.jsx(dr,{}),r.jsx(xr,{position:"fixed",sx:{width:{sm:`calc(100% - ${p}px)`},mr:{sm:`${p}px`}},children:r.jsxs(F,{sx:{paddingY:"10px"},children:[r.jsx(c,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:Y,sx:{mr:0,display:{sm:"none"}},children:r.jsx(mr,{})}),r.jsx(e,{sx:{display:{xs:"none",sm:"flex"}},children:r.jsx(b,{variant:"h4",noWrap:!0,component:"div",children:"POS"})}),r.jsx(nr,{}),r.jsx("a",{href:"/pos-offline",children:r.jsx(c,{color:"inherit",sx:{ml:0,p:"10px",color:"default","& .MuiSvgIcon-root":{fontSize:30}},type:"button",title:"Offline Mode",children:r.jsx(X,{})})}),r.jsx(U,{href:"/dashboard",children:r.jsx(c,{color:"inherit",sx:{ml:0,p:"10px",color:"default","& .MuiSvgIcon-root":{fontSize:30}},type:"button",children:r.jsx(M,{})})})]})}),r.jsxs(e,{component:"main",sx:{flexGrow:1,p:3,width:{sm:`calc(100% - ${p}px)`}},children:[r.jsx(F,{}),r.jsxs(i,{container:!0,spacing:1,sx:{mb:8},children:[r.jsx(lr,{templates:J,setTemplates:f}),k==="products"&&n&&r.jsx(i,{size:12,sx:{mb:2},children:r.jsxs(tr,{separator:"/",sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsxs(E,{component:"button",variant:"body2",onClick:t=>{t.preventDefault(),h(null),l([]),u===0&&x(s)},sx:{cursor:"pointer",color:"primary.main",display:"flex",alignItems:"center",gap:.5},children:[r.jsx(M,{sx:{fontSize:"18px"}}),"Home"]}),n.parent_id&&r.jsxs(E,{component:"button",variant:"body2",onClick:t=>{t.preventDefault();const m=d?.find(C=>C.id===n.parent_id);m&&g(m)},sx:{cursor:"pointer",color:"primary.main",display:"flex",alignItems:"center",gap:.5},children:[r.jsx(fr,{size:18}),d?.find(t=>t.id===n.parent_id)?.name]}),r.jsxs(e,{sx:{display:"flex",alignItems:"center",gap:.5,color:"text.primary",fontWeight:"bold"},children:[r.jsx(Z,{size:18}),n.name]})]})}),k==="products"&&r.jsxs(r.Fragment,{children:[j&&j.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(i,{size:12,sx:{mb:2},children:r.jsx(b,{variant:"subtitle2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Subcategories"})}),j.map(t=>r.jsx(i,{size:{xs:6,sm:4,md:3,lg:2},sx:{p:1},children:r.jsx(P,{collection:t,onClick:g,hasChildren:t.children&&t.children.length>0})},t.id)),r.jsx(i,{size:12,sx:{my:2},children:r.jsx(y,{})})]}),$?.map(t=>r.jsx(i,{size:{xs:6,sm:6,md:2},sx:{cursor:"pointer"},children:r.jsx(or,{product:t})},t.id+t.batch_number))]}),u===0&&!n&&r.jsxs(r.Fragment,{children:[r.jsx(i,{size:12,sx:{mt:4,mb:2},children:r.jsx(y,{textAlign:"left",children:r.jsx(b,{variant:"h6",color:"text.secondary",children:"Collections"})})}),d?.map(t=>r.jsx(i,{size:{xs:6,sm:4,md:3,lg:2},sx:{p:1},children:r.jsx(P,{collection:t,onClick:g,hasChildren:t.children&&t.children.length>0})},t.id))]}),!w&&r.jsx(ar,{drawerWidth:p,categories:L,setProducts:x,setTemplates:f,onViewModeChange:q,tabValue:u,onTabChange:N})]})]}),r.jsxs(e,{component:"nav",sx:{width:{sm:p},flexShrink:{sm:0}},children:[r.jsxs(H,{variant:"temporary",open:v,onTransitionEnd:R,onClose:T,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:"100%"}},anchor:"right",children:[r.jsxs(hr,{children:[r.jsx(O,{customers:S}),r.jsx(c,{onClick:T,children:r.jsx(rr,{})})]}),B]}),r.jsx(H,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:p}},open:!0,anchor:"right",children:B})]})]})]})}export{Xo as default};
