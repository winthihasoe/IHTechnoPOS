import{j as r,r as i,f as L,d as z,H as B,L as v,b as T}from"./currencyStore-Dk9RVyyc.js";import{A as w}from"./AuthenticatedLayout-CblcNqH9.js";import{B as H,H as E}from"./Home-BKek3M8v.js";import{S as O}from"./sweetalert2.esm.all-q958Q1qq.js";import{c as k}from"./createSvgIcon-B7q9zImx.js";import M from"./FormDialog-k2NLfBwH.js";import q from"./ProductSearch-Dx8m2smh.js";import V from"./PurchaseCartItems-Co0Vu950.js";import{P as W}from"./PaymentsCheckoutDialog-0sdlSFZF.js";import Y from"./PurchaseAppBar-BUSY4rOa.js";import{u as S}from"./app-5dnBcRp6.js";import{B as N}from"./Box-j1BTqM2v.js";import{T as G}from"./Typography-DOI0NvTt.js";import{G as a}from"./Grid-6qcTmjc4.js";import{F as R,I as J,S as K,T as d}from"./TextField-DpXyhoD7.js";import{M as Q}from"./MenuItem-CEIQJ6q4.js";import{A as U}from"./Autocomplete-DfOnEm4b.js";import{I as X}from"./IconButton-PbvyX_sG.js";import{D as g}from"./Divider-D4ysiqwk.js";import"./Payments-DSgOMdsa.js";import"./Receipt-DnWIM4Bg.js";import"./index-RHigu7j0.js";import"./index-NgBaJJmW.js";import"./infoshop-hkdJrh2a.js";import"./Toolbar-f3-_dlD0.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BxRvtGIq.js";import"./index-Rj29YxKv.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./ListItemButton-DDnSs3En.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./useForkRef-DgOCCfFR.js";import"./ButtonBase-CjVOrSoJ.js";import"./useTimeout--F2UA0HV.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./listItemIconClasses-vD-ryqxg.js";import"./ListItemText--0XI93dL.js";import"./listItemTextClasses-DNpdtY9T.js";import"./useSlot-PFdYD2CN.js";import"./Collapse-CHgnjEwQ.js";import"./useTheme-CvovRv7W.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./CssBaseline-DBisayGl.js";import"./index-CsFzvdgQ.js";import"./extendSxProp-Co6nc6xJ.js";import"./AppBar-CxLpgr4B.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Paper-Df0ljdBt.js";import"./Tooltip-DjVJzg5-.js";import"./index-DM5RHFVd.js";import"./useControlled-DRAJCB75.js";import"./useId-9XzpHYrc.js";import"./Grow-D31e1sMI.js";import"./Popper-pZx5Iht2.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-DuznN7Ax.js";import"./Drawer-Dk2A_cxp.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./Modal-D1QunwiJ.js";import"./ListItem-BK8RisGy.js";import"./isMuiElement-HmfyYHhb.js";import"./DialogContent-Cz4a0t2H.js";import"./DialogTitle-osZsMdGC.js";import"./DialogActions-BraO_KzF.js";import"./Button-aMjmD1gp.js";import"./CircularProgress-B97ut0O7.js";import"./useFormControl-Cowmrh0y.js";import"./react-select.esm-Cy0FGMM3.js";import"./Select-ef7c0426.esm-CXaJakO2.js";import"./toPropertyKey-C9c9JG92.js";import"./floating-ui.dom-CpMS8hwT.js";import"./lodash-CwOxCT-R.js";import"./AddToPurchase-Sm_ytFz-.js";import"./Close-B9rgBTOR.js";import"./app-CDk-Xqy5.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./Delete-DDMcR4JX.js";import"./currencyFormatter-Be2b0Ktm.js";import"./numeral-NHlY-3dw.js";import"./TableContainer-Bx1in-E2.js";import"./TableRow-BMfflATG.js";import"./TableCell-DMEjcBPA.js";import"./PrintReceiptModal-Csw0Y3uy.js";import"./ReceiptDisplay-_SLXtf8O.js";import"./Print-5v-Lf9Qb.js";import"./snapdom-dxSfVsGw.js";import"./Barcode-DaGb-pRP.js";import"./JsBarcode-DwekVVut.js";import"./download-CxbKlL8J.js";import"./createLucideIcon-BMpC51dL.js";import"./Card-C4NAxgST.js";import"./CardMedia-lO_mnymB.js";import"./Percent-BCjtx-gP.js";import"./CreditCard-Dwl4hWaF.js";import"./HighlightOff-Bl6nUsD3.js";import"./x-DFsc1drM.js";import"./InputAdornment-DZOHCUsF.js";import"./FormControlLabel-eGygXIaI.js";import"./Checkbox-DmEdO0Ay.js";import"./SwitchBase-DLVdjlNh.js";import"./ArrowBackIosNew-DODCClIX.js";import"./dividerClasses-BJEnnqiu.js";import"./Close-kFSrCAJM.js";import"./usePreviousProps-Dg0VAGfT.js";import"./Chip-DT462TV2.js";const Z=k(r.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}));function tt({vendors:u,purchase:P,stores:h}){const{cartState:f,cartTotal:x}=S(),{selectedVendor:n,setSelectedVendor:c}=i.useContext(L),[y,j]=i.useState(!1),[p,C]=i.useState(u),[_,b]=i.useState(!1),F=()=>{j(!1)},D=e=>{C(o=>{const t={id:e.id,name:e.name,balance:e.balance},s=[...o,t];return c(t),s})};i.useEffect(()=>{if(p){const e=p.find(o=>o.id===1);c(e||null)}},[u]),i.useEffect(()=>{},[f]);const I=e=>{e.preventDefault();const o=new FormData(e.currentTarget),t=Object.fromEntries(o.entries());t.cartItems=f,t.total_amount=x,t.amount_paid=x,T.post("/purchase/store",t).then(s=>{O.fire({title:"Success!",text:s.data.message,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}).catch(s=>{console.error("Submission failed with errors:",s),console.log(t)})},[m,A]=i.useState({store_id:h[0].id,reference_no:"",purchase_date:z().format("YYYY-MM-DD")}),l=e=>{const{name:o,value:t}=e.target;A({...m,[o]:t})};return r.jsxs(w,{children:[r.jsx(B,{title:"Add Purchase"}),r.jsx(N,{className:"mb-10",children:r.jsxs(H,{"aria-label":"breadcrumb",children:[r.jsxs(v,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/",children:[r.jsx(E,{sx:{mr:.5,mb:"3px"},fontSize:"inherit"}),"Home"]}),r.jsx(v,{underline:"hover",color:"inherit",href:"/purchases",children:"Purchases"}),r.jsx(G,{sx:{color:"text.primary"},children:P?"Edit Product":"Add Purchase"})]})}),r.jsx("form",{id:"purchase-form",encType:"multipart/form-data",onSubmit:I,children:r.jsxs(a,{container:!0,spacing:2,children:[r.jsx(a,{size:3,children:r.jsxs(R,{fullWidth:!0,children:[r.jsx(J,{children:"Store"}),r.jsx(K,{value:m.store_id,label:"Store",onChange:l,required:!0,name:"store_id",children:h.map(e=>r.jsx(Q,{value:e.id,children:e.name},e.id))})]})}),r.jsx(a,{size:2,children:r.jsx(d,{label:"Reference No",name:"reference_no",value:m.reference_no,onChange:l,fullWidth:!0,required:!0})}),r.jsx(a,{size:3,children:r.jsx(d,{label:"Purchase Date",name:"purchase_date",placeholder:"Purchase Date",fullWidth:!0,type:"date",slotProps:{inputLabel:{shrink:!0}},value:m.purchase_date,onChange:l,required:!0})}),r.jsxs(a,{size:4,className:"flex items-center",children:[Array.isArray(p)&&r.jsx(U,{disablePortal:!0,options:p,fullWidth:!0,required:!0,value:n||null,getOptionKey:e=>e.id,getOptionLabel:e=>typeof e=="string"?e:e.name+" | "+parseFloat(e.balance).toFixed(2),onChange:(e,o)=>{c(o)},renderInput:e=>r.jsx(d,{...e,label:"Vendor"})}),r.jsx(X,{onClick:()=>j(!0),size:"large",sx:{ml:"1rem",bgcolor:"success.main",width:"50px",height:"50px",color:"white","&:hover":{bgcolor:"success.dark"}},children:r.jsx(Z,{fontSize:"inherit"})}),r.jsx(M,{open:y,handleClose:F,onSuccess:D,contactType:"vendor"})]})]})}),r.jsx(g,{sx:{my:"1rem"}}),r.jsx(q,{}),r.jsx(g,{sx:{my:"1rem"}}),r.jsx(V,{}),r.jsx(Y,{setOpenPayment:b,selectedVendor:n,disable:!m.reference_no}),r.jsx(W,{open:_,setOpen:b,useCart:S,selectedContact:n,formData:m})]})}export{tt as default};
