import{r as s,f as M,j as r,R as L}from"./currencyStore-Dk9RVyyc.js";import{D as S}from"./Delete-DDMcR4JX.js";import k from"./QuantityInput-GBNfqYnf.js";import v from"./CartItemModal-DjcGF4YG.js";import{useAppConfig as D}from"./AppConfigContext-XFUA3Mas.js";import{u as A}from"./SalesContext-CG9t8_rq.js";import{p as F}from"./product-placeholder-DL4NWfZp.js";import{u as T}from"./currencyFormatter-Be2b0Ktm.js";import{L as w}from"./List-OrinuOpJ.js";import{L as q}from"./ListItem-BK8RisGy.js";import{L as B,A as N}from"./ListItemAvatar-DpHqHrXm.js";import{L as O}from"./ListItemText--0XI93dL.js";import{T as x}from"./Typography-DOI0NvTt.js";import{B as R}from"./Box-j1BTqM2v.js";import{I as P}from"./IconButton-PbvyX_sG.js";import{D as z}from"./Divider-D4ysiqwk.js";import{M as J}from"./TextField-DpXyhoD7.js";import{M as f}from"./MenuItem-CEIQJ6q4.js";import"./createSvgIcon-B7q9zImx.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BxRvtGIq.js";import"./index-Rj29YxKv.js";import"./Add-5ZpxTNJx.js";import"./Remove-6EDtWCFk.js";import"./Close-B9rgBTOR.js";import"./Visibility-BHSl7kaI.js";import"./VisibilityOff-CyahlUox.js";import"./Commission-BSR3AjUX.js";import"./Grid-6qcTmjc4.js";import"./useTheme-CvovRv7W.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./extendSxProp-Co6nc6xJ.js";import"./isMuiElement-HmfyYHhb.js";import"./InputAdornment-DZOHCUsF.js";import"./useFormControl-Cowmrh0y.js";import"./DialogContent-Cz4a0t2H.js";import"./useSlot-PFdYD2CN.js";import"./useForkRef-DgOCCfFR.js";import"./Paper-Df0ljdBt.js";import"./Modal-D1QunwiJ.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./useId-9XzpHYrc.js";import"./DialogTitle-osZsMdGC.js";import"./Chip-DT462TV2.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./ButtonBase-CjVOrSoJ.js";import"./useTimeout--F2UA0HV.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./Alert-CsOnCL1T.js";import"./Close-kFSrCAJM.js";import"./DialogActions-BraO_KzF.js";import"./Button-aMjmD1gp.js";import"./CircularProgress-B97ut0O7.js";import"./numeral-NHlY-3dw.js";import"./ListContext-CTnR0k9S.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./listItemTextClasses-DNpdtY9T.js";import"./index-CsFzvdgQ.js";import"./dividerClasses-BJEnnqiu.js";import"./debounce-Be36O1Ab.js";import"./index-DM5RHFVd.js";import"./useSlotProps-DuznN7Ax.js";import"./Grow-D31e1sMI.js";import"./mergeSlotProps-D_PRovB-.js";import"./useControlled-DRAJCB75.js";import"./listItemIconClasses-vD-ryqxg.js";function mr(){const i=T(),{return_sale:Q,edit_sale:m,sale_data:a}=D(),{cartState:h,removeFromCart:I,emptyCart:U,emptyCartItemsOnly:j,addToCart:n}=A(),{setCartItemModalOpen:C,setSelectedCartItem:y,cartItemModalOpen:g}=s.useContext(M),[p,c]=s.useState(null),[l,_]=s.useState(null),b=!!p,E=(t,o)=>{c(t.currentTarget),_(o)},d=()=>{c(null)},u=(t,o)=>{if(o==="free"){const e={...t,price:0,cost:0,add_new_item:!0,quantity:1,is_free:!0};n(e)}else if(o==="duplicate"){const e={...t,add_new_item:!0};n(e)}d()};return s.useEffect(()=>{m&&a?.cart_snapshot&&(j(),JSON.parse(a.cart_snapshot).forEach(o=>{n(o,o.quantity)}))},[m,a?.cart_snapshot]),r.jsxs(w,{sx:{width:"100%",bgcolor:"background.paper"},children:[h.map((t,o)=>r.jsxs(L.Fragment,{children:[r.jsxs(q,{alignItems:"center",sx:{padding:{sm:.5,xs:0},paddingY:.5},children:[r.jsx(B,{onClick:e=>E(e,t),className:"cursor-pointer",children:r.jsx(N,{variant:"rounded",sx:{width:50,height:50},alt:t.name,src:t.image_url?t.image_url:F})}),r.jsx(O,{primary:r.jsxs(x,{component:"h5",sx:{fontWeight:"bold",cursor:"pointer",fontSize:{sm:"1rem",xs:"0.9rem"}},className:"hover:underline",onClick:()=>{y({...t,cart_index:o}),C(!0)},children:[t.name,t.unit?` | ${t.unit}`:""]}),sx:{ml:"10px"},secondary:r.jsx(r.Fragment,{children:r.jsxs(x,{component:"span",variant:"body2",sx:{color:"text.primary",display:"inline"},children:[(t.price-t.discount)*t.quantity===0?r.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-md",children:"Free"}):r.jsxs(r.Fragment,{children:[i(t.price-t.discount,!1)," X ",t.quantity," = ",r.jsxs("b",{children:[i((t.price-t.discount)*t.quantity,!1),t.flat_discount>0&&" - "+i(t.flat_discount,!1)]})]}),r.jsx("br",{})]})})}),r.jsxs(R,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[r.jsx(k,{cartItem:{...t,cart_index:o}}),r.jsx(P,{"aria-label":"delete",color:"error",onClick:()=>I(o),children:r.jsx(S,{})})]})]}),r.jsx(z,{variant:"inset",component:"li"}),r.jsxs(J,{id:"cart-menu",anchorEl:p,open:b,onClose:d,slotProps:{list:{"aria-labelledby":"basic-button"}},children:[r.jsx(f,{onClick:()=>u(l,"free"),children:"ADD FREE ITEMS"}),r.jsx(f,{onClick:()=>u(l,"duplicate"),children:"DUPLICATE"})]})]},o)),g&&r.jsx(v,{})]})}export{mr as default};
