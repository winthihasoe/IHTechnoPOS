import{c as k,r as o,f as D,j as e,d as j}from"./currencyStore-Dk9RVyyc.js";import{A as M}from"./Add-5ZpxTNJx.js";import{E as _}from"./Edit-ByvjS5ky.js";import{M as F,C as R}from"./MUITimePicker-BanoNu3u.js";import{R as H}from"./Refresh-Be3nBego.js";import L from"./FormDialog-k2NLfBwH.js";import{M as W}from"./MUIDatePicker-uF2qI3Qp.js";import{B as i}from"./Box-j1BTqM2v.js";import{G as a}from"./Grid-6qcTmjc4.js";import{T as C}from"./Tooltip-DjVJzg5-.js";import{I as p}from"./IconButton-PbvyX_sG.js";import{T}from"./TextField-DpXyhoD7.js";import{A as B}from"./Autocomplete-DfOnEm4b.js";import{D as q}from"./Divider-D4ysiqwk.js";import"./createSvgIcon-B7q9zImx.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BxRvtGIq.js";import"./index-Rj29YxKv.js";import"./en-gb-BMmXCQZs.js";import"./useMobilePicker-BIozrTWd.js";import"./index-P4sNTowN.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./index-DM5RHFVd.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./useTheme-CvovRv7W.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./extendSxProp-Co6nc6xJ.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./useControlled-DRAJCB75.js";import"./useTimeout--F2UA0HV.js";import"./useForkRef-DgOCCfFR.js";import"./ownerDocument-DW-IO8s5.js";import"./useId-9XzpHYrc.js";import"./useSlotProps-DuznN7Ax.js";import"./useSlot-PFdYD2CN.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./Modal-D1QunwiJ.js";import"./ownerWindow-HkKU3E4x.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./DialogContent-Cz4a0t2H.js";import"./Paper-Df0ljdBt.js";import"./useFormControl-Cowmrh0y.js";import"./InputAdornment-DZOHCUsF.js";import"./index-JJ5bZ37u.js";import"./Button-aMjmD1gp.js";import"./ButtonBase-CjVOrSoJ.js";import"./CircularProgress-B97ut0O7.js";import"./DialogActions-BraO_KzF.js";import"./ListItem-BK8RisGy.js";import"./ListContext-CTnR0k9S.js";import"./isMuiElement-HmfyYHhb.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./Chip-DT462TV2.js";import"./List-OrinuOpJ.js";import"./MobileTimePicker-CFR5bNoc.js";import"./sweetalert2.esm.all-q958Q1qq.js";import"./DialogTitle-osZsMdGC.js";import"./debounce-Be36O1Ab.js";import"./Grow-D31e1sMI.js";import"./mergeSlotProps-D_PRovB-.js";import"./DatePicker--Uxs9Qj-.js";import"./Popper-pZx5Iht2.js";import"./Close-kFSrCAJM.js";import"./usePreviousProps-Dg0VAGfT.js";import"./dividerClasses-BJEnnqiu.js";function ot({customers:c}){k().props.return_sale;const[g,d]=o.useState(!1),[s,I]=o.useState(c),[w,u]=o.useState(!1),{selectedCustomer:y,setSelectedCustomer:l,saleDate:n,setSaleDate:b,saleTime:m,setSaleTime:x,isSaleTimeManual:S,setIsSaleTimeManual:f}=o.useContext(D),E=[{id:"create-new",name:"Add new customer",isCreateNew:!0},...s],P=()=>{d(!1)},v=t=>{I(r=>{const h={id:t.id,name:t.name,balance:t.balance},O=[...r,h];return l(h),O})};o.useEffect(()=>{if(s){const t=s.find(r=>r.id===1)||s[0];l(t||null)}},[c]);const A=()=>{f(!0),u(!0)},z=()=>{u(!1)},N=()=>{f(!1),x(j().format("HH:mm"))};return e.jsx(i,{sx:{width:"100%"},children:e.jsxs(a,{sx:{width:"100%",marginY:{xs:"1rem",sm:"1.2rem"},alignItems:"center",justifyContent:"space-between"},container:!0,spacing:2,flexDirection:{xs:"column-reverse",sm:"row"},alignItems:"center",children:[e.jsx(C,{title:n?"":"Sale date is required",arrow:!0,placement:"top",open:!n,disableHoverListener:!0,PopperProps:{disablePortal:!0},children:e.jsx(a,{size:{xs:12,sm:6},width:"100%",children:e.jsx(W,{name:"sale_date",label:"Date",value:n,onChange:b,size:"small"})})}),e.jsx(C,{title:m?"":"Sale time is required",arrow:!0,placement:"top",open:!m,disableHoverListener:!0,PopperProps:{disablePortal:!0},children:e.jsx(a,{size:{xs:12,sm:6},width:"100%",children:w?e.jsxs(i,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(F,{name:"sale_time",label:"Time",value:m,onChange:x,size:"small",sx:{flex:1}}),e.jsx(p,{size:"small",onClick:z,color:"primary",title:"Save time",children:e.jsx(R,{})})]}):e.jsxs(i,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(T,{name:"sale_time",label:"Time",value:j(m,"HH:mm").format("hh:mm A"),size:"small",fullWidth:!0,disabled:!0,slotProps:{input:{readOnly:!0}}}),e.jsx(p,{size:"small",onClick:A,color:"primary",title:"Edit time",children:e.jsx(_,{})}),S&&e.jsx(p,{size:"small",onClick:N,color:"secondary",title:"Reset to current time",children:e.jsx(H,{})})]})})}),e.jsx(a,{size:{xs:12,sm:12},width:"100%",children:Array.isArray(s)&&e.jsx(B,{disablePortal:!0,options:E,fullWidth:!0,value:y||null,getOptionKey:t=>t.id,getOptionLabel:t=>t.isCreateNew?"+ Add new customer":typeof t=="string"?t:t.name+" | "+parseFloat(t.balance).toFixed(2),renderOption:(t,r)=>r.isCreateNew?e.jsxs(i,{children:[e.jsxs(i,{component:"li",...t,sx:{color:"primary.main",fontWeight:600,py:1.5,display:"flex",alignItems:"center",gap:1,"&:hover":{backgroundColor:"primary.100",color:"primary.900"}},children:[e.jsx(M,{sx:{fontSize:18}}),"Add new customer"]}),e.jsx(q,{sx:{mt:1}})]}):e.jsxs(i,{component:"li",...t,children:[r.name," | ",parseFloat(r.balance).toFixed(2)]}),onChange:(t,r)=>{if(r?.isCreateNew){d(!0);return}l(r)},size:"small",renderInput:t=>e.jsx(T,{...t,label:"Customer"})})}),e.jsx(L,{open:g,handleClose:P,onSuccess:v,contactType:"customer"})]})})}export{ot as default};
