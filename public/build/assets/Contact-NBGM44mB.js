import{j as t,r as i,H as B,a as F,L as m}from"./currencyStore-Dk9RVyyc.js";import{A as L}from"./AuthenticatedLayout-CblcNqH9.js";import{A as M}from"./Add-5ZpxTNJx.js";import{P as k}from"./Print-5v-Lf9Qb.js";import{c as y}from"./createSvgIcon-B7q9zImx.js";import{n as N}from"./numeral-NHlY-3dw.js";import O from"./FormDialog-k2NLfBwH.js";import{C as V}from"./CustomPagination-DIeBJN57.js";import{A as q}from"./AddPaymentDialog-CoxwDOZB.js";import{P as H}from"./Payments-DSgOMdsa.js";import{u as R}from"./index-JJ5bZ37u.js";import G from"./MobileContactsList-DZd4OtCa.js";import"./SalesContext-CG9t8_rq.js";import{u as W}from"./useTheme-CvovRv7W.js";import{G as n}from"./Grid-6qcTmjc4.js";import{T as $}from"./TextField-DpXyhoD7.js";import{B as b}from"./Button-aMjmD1gp.js";import{B as Q}from"./Box-j1BTqM2v.js";import{T as p}from"./Tooltip-DjVJzg5-.js";import{I as h}from"./IconButton-PbvyX_sG.js";import{D as U}from"./DataGrid-CyDBJMLY.js";import"./Receipt-DnWIM4Bg.js";import"./index-RHigu7j0.js";import"./index-NgBaJJmW.js";import"./infoshop-hkdJrh2a.js";import"./Toolbar-f3-_dlD0.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BxRvtGIq.js";import"./index-Rj29YxKv.js";import"./Divider-D4ysiqwk.js";import"./dividerClasses-BJEnnqiu.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./ListItemButton-DDnSs3En.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./useForkRef-DgOCCfFR.js";import"./ButtonBase-CjVOrSoJ.js";import"./useTimeout--F2UA0HV.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./listItemIconClasses-vD-ryqxg.js";import"./ListItemText--0XI93dL.js";import"./listItemTextClasses-DNpdtY9T.js";import"./useSlot-PFdYD2CN.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./extendSxProp-Co6nc6xJ.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Collapse-CHgnjEwQ.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./CssBaseline-DBisayGl.js";import"./AppBar-CxLpgr4B.js";import"./Paper-Df0ljdBt.js";import"./Drawer-Dk2A_cxp.js";import"./index-DM5RHFVd.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./Modal-D1QunwiJ.js";import"./ListItem-BK8RisGy.js";import"./isMuiElement-HmfyYHhb.js";import"./sweetalert2.esm.all-q958Q1qq.js";import"./DialogContent-Cz4a0t2H.js";import"./useId-9XzpHYrc.js";import"./DialogTitle-osZsMdGC.js";import"./DialogActions-BraO_KzF.js";import"./useFormControl-Cowmrh0y.js";import"./useSlotProps-DuznN7Ax.js";import"./Grow-D31e1sMI.js";import"./useControlled-DRAJCB75.js";import"./CircularProgress-B97ut0O7.js";import"./select-DF-qibkA.js";import"./floating-ui.dom-CpMS8hwT.js";import"./tslib.es6-BUas5LQb.js";import"./utils-NikRBbYi.js";import"./chevron-down-C5MZ1frv.js";import"./createLucideIcon-BMpC51dL.js";import"./chevron-right-BAlzn6w9.js";import"./Close-B9rgBTOR.js";import"./InputAdornment-DZOHCUsF.js";import"./MenuItem-CEIQJ6q4.js";import"./getThemeProps-DKKyYQML.js";import"./index-C7dwhapP.js";import"./import-wrapper-prod-jq4Om1Jp.js";import"./snapdom-dxSfVsGw.js";import"./JsBarcode-DwekVVut.js";import"./printer-BGHrbooI.js";import"./useThemeProps-Cgy5Iu59.js";import"./Popper-pZx5Iht2.js";import"./index-P4sNTowN.js";import"./with-selector-Bw9PUS5X.js";import"./toPropertyKey-C9c9JG92.js";import"./Switch-DzXzblLj.js";import"./SwitchBase-DLVdjlNh.js";import"./Chip-DT462TV2.js";import"./Badge-DrYGhX8S.js";import"./usePreviousProps-Dg0VAGfT.js";import"./Autocomplete-DfOnEm4b.js";import"./Close-kFSrCAJM.js";import"./FormControlLabel-eGygXIaI.js";import"./KeyboardArrowRight-C0as7Qna.js";import"./TableCell-DMEjcBPA.js";import"./Checkbox-DmEdO0Ay.js";const Y=y(t.jsx("path",{d:"m6 2 .01 6L10 12l-3.99 4.01L6 22h12v-6l-4-4 4-3.99V2zm10 14.5V20H8v-3.5l4-4z"})),J=y(t.jsx("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2m-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),K=l=>[{field:"id",headerName:"ID",width:80},{field:"name",headerName:"Name",width:200,renderCell:e=>t.jsx(m,{underline:"hover",href:"#",className:"hover:underline",onClick:s=>{s.preventDefault(),l(e.row,"contact_edit")},children:t.jsx("p",{className:"font-bold",children:e.value})})},{field:"balance",headerName:"Balance",width:160,valueGetter:e=>parseFloat(e),renderCell:e=>t.jsx(b,{onClick:()=>l(e.row,"add_payment"),variant:"text",fullWidth:!0,sx:{textAlign:"left",fontWeight:"bold",justifyContent:"flex-end"},children:N(e.value).format("0,00.00")})},{field:"phone",headerName:"Phone",width:120},{field:"whatsapp",headerName:"Whatsapp",width:120},{field:"email",headerName:"Email",width:100},{field:"address",headerName:"Address",width:200},{field:"created_at",headerName:"Created At",width:100},{field:"action",headerName:"Actions",width:180,renderCell:e=>{const s=e.row.type==="vendor"?"/purchases":"/sales";return e.row.type,t.jsxs(t.Fragment,{children:[t.jsx(m,{href:"/reports/"+e.row.id+"/"+e.row.type,children:t.jsx(p,{title:"REPORT",children:t.jsx(h,{color:"primary",children:t.jsx(k,{})})})}),e.row.type==="customer"&&t.jsx(m,{href:"/pending-sales-receipt/"+e.row.id,children:t.jsx(p,{title:"PENDING RECEIPT",children:t.jsx(h,{color:"primary",children:t.jsx(J,{})})})}),t.jsx(m,{href:`${s}?contact_id=${e.row.id}&end_date=&query=&start_date=&status=pending&store=0`,children:t.jsx(p,{title:"CREDIT SALE",children:t.jsx(h,{color:"alert",children:t.jsx(Y,{})})})}),t.jsx(m,{href:`/payments${s}?contact_id=${e.row.id}&store=0`,children:t.jsx(p,{title:"PAYMENTS",children:t.jsx(h,{color:"success",children:t.jsx(H,{})})})})]})}}];function Ye({contacts:l,type:e,stores:s}){const[S,u]=i.useState(!1),[j,f]=i.useState(null),[_,w]=i.useState(!1),[a,T]=i.useState(l),[I,P]=i.useState(0),A=W(),C=R(A.breakpoints.down("sm")),[c,v]=i.useState({per_page:100,search_query:""}),E=()=>{f(null),u(!0)},g=(r,o)=>{f(r),o=="contact_edit"?u(!0):o=="add_payment"&&w(!0)},z=()=>{f(null),u(!1)},d=r=>{const o={preserveState:!0,preserveScroll:!0,only:["contacts"],onSuccess:x=>{T(x.props.contacts)}};F.get(r,{...c},o)};i.useEffect(()=>{d(window.location.pathname)},[c]);const D=r=>{d(window.location.pathname)};return i.useEffect(()=>{if(a){const r=Object.values(a.data).reduce((o,x)=>o+parseFloat(x.balance),0);P(r)}},[a]),t.jsxs(L,{children:[t.jsx(B,{title:e[0].toUpperCase()+e.slice(1)+"s"}),t.jsxs(n,{container:!0,spacing:2,alignItems:"center",sx:{width:"100%"},children:[t.jsx(n,{size:{xs:12,sm:2,md:3},children:t.jsx("div",{className:"bg-red-200 p-4 rounded text-red-950 text-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{children:"Balance:"})," ",t.jsx("div",{className:"font-bold",children:N(I).format("0,00.00")})]})})}),t.jsxs(n,{size:{xs:12,sm:10,md:9},spacing:2,container:!0,justifyContent:"end",alignItems:"center",flexDirection:{xs:"column",sm:"row"},children:[t.jsx(n,{size:{xs:12,sm:8},children:t.jsx($,{name:"search_query",label:"Search",variant:"outlined",size:"small",value:c?.search_query,onChange:r=>v(o=>({...o,search_query:r.target.value})),required:!0,fullWidth:!0,onFocus:r=>{r.target.select()},slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(n,{size:{xs:12,sm:3},children:t.jsxs(b,{variant:"contained",startIcon:t.jsx(M,{}),onClick:E,fullWidth:!0,size:"small",color:"success",children:["Add ",e[0].toUpperCase()+e.slice(1)]})})]}),!C&&t.jsx(Q,{className:"py-6 w-full",sx:{display:"grid",gridTemplateColumns:"1fr",height:"calc(100vh - 240px)"},children:t.jsx(U,{rows:a.data,columns:K(g),getRowId:r=>r.id,slotProps:{toolbar:{showQuickFilter:!0}},initialState:{columns:{columnVisibilityModel:{address:!1,email:!1,created_at:!1}}},hideFooter:!0})}),C&&t.jsx(G,{contacts:a.data,handleContactEdit:g}),t.jsx(n,{size:12,container:!0,justifyContent:"end",children:t.jsx(V,{refreshTable:d,setSearchTerms:v,searchTerms:c,data:a})})]}),t.jsx(O,{open:S,handleClose:z,contact:j,contactType:e,onSuccess:D}),t.jsx(q,{open:_,setOpen:w,selectedContact:j?.id,is_customer:e==="customer",stores:s,refreshTable:d})]})}export{Ye as default};
