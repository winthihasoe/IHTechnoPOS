import{r as x,j as t,d as R,H as q,a as T,b as W}from"./currencyStore-Dk9RVyyc.js";import{A as M}from"./AuthenticatedLayout-CblcNqH9.js";import{A as w}from"./AddCircle-CG2fmhqP.js";import{D as z}from"./Delete-DDMcR4JX.js";import{S as _}from"./sweetalert2.esm.all-q958Q1qq.js";import{n as S}from"./numeral-NHlY-3dw.js";import A from"./InventoryItemDialog-tShiXqQs.js";import{G as u}from"./Grid-6qcTmjc4.js";import{T as h}from"./TextField-DpXyhoD7.js";import{M as B}from"./MenuItem-CEIQJ6q4.js";import{B as I}from"./Button-aMjmD1gp.js";import{T as D}from"./TableContainer-Bx1in-E2.js";import{P as E}from"./Paper-Df0ljdBt.js";import{T as L,a as O,b as g,c as U}from"./TableRow-BMfflATG.js";import{a as k,T as i}from"./TableCell-DMEjcBPA.js";import{A as Y}from"./Autocomplete-DfOnEm4b.js";import{I as H}from"./InputAdornment-DZOHCUsF.js";import{I as V}from"./IconButton-PbvyX_sG.js";import{c as G}from"./clsx-B-dksMZM.js";import{g as Q,b as J,u as K,s as X,c as Z}from"./memoTheme-BxRvtGIq.js";import{B as $}from"./Box-j1BTqM2v.js";import"./createSvgIcon-B7q9zImx.js";import"./Payments-DSgOMdsa.js";import"./Receipt-DnWIM4Bg.js";import"./index-RHigu7j0.js";import"./index-NgBaJJmW.js";import"./infoshop-hkdJrh2a.js";import"./Toolbar-f3-_dlD0.js";import"./Divider-D4ysiqwk.js";import"./dividerClasses-BJEnnqiu.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./ListItemButton-DDnSs3En.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./useForkRef-DgOCCfFR.js";import"./ButtonBase-CjVOrSoJ.js";import"./useTimeout--F2UA0HV.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./listItemIconClasses-vD-ryqxg.js";import"./ListItemText--0XI93dL.js";import"./listItemTextClasses-DNpdtY9T.js";import"./useSlot-PFdYD2CN.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./useTheme-CvovRv7W.js";import"./extendSxProp-Co6nc6xJ.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Collapse-CHgnjEwQ.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./CssBaseline-DBisayGl.js";import"./AppBar-CxLpgr4B.js";import"./Tooltip-DjVJzg5-.js";import"./index-DM5RHFVd.js";import"./useControlled-DRAJCB75.js";import"./useId-9XzpHYrc.js";import"./Grow-D31e1sMI.js";import"./Popper-pZx5Iht2.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-DuznN7Ax.js";import"./Drawer-Dk2A_cxp.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./Modal-D1QunwiJ.js";import"./ListItem-BK8RisGy.js";import"./isMuiElement-HmfyYHhb.js";import"./Close-B9rgBTOR.js";import"./DialogContent-Cz4a0t2H.js";import"./DialogTitle-osZsMdGC.js";import"./DialogActions-BraO_KzF.js";import"./index-Rj29YxKv.js";import"./CircularProgress-B97ut0O7.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./useFormControl-Cowmrh0y.js";import"./Close-kFSrCAJM.js";import"./usePreviousProps-Dg0VAGfT.js";import"./Chip-DT462TV2.js";function tt(l){return Q("MuiTableFooter",l)}J("MuiTableFooter",["root"]);const et=l=>{const{classes:m}=l;return Z({root:["root"]},tt,m)},ot=X("tfoot",{name:"MuiTableFooter",slot:"Root"})({display:"table-footer-group"}),rt={variant:"footer"},F="tfoot",it=x.forwardRef(function(m,f){const j=K({props:m,name:"MuiTableFooter"}),{className:y,component:p=F,...a}=j,c={...j,component:p},v=et(c);return t.jsx(k.Provider,{value:rt,children:t.jsx(ot,{as:p,className:G(v.root,y),ref:f,role:p===F?null:"rowgroup",ownerState:c,...a})})}),We=({inventory_items:l,stores:m})=>{const[f,j]=x.useState(l),[y,p]=x.useState(!1),[a,c]=x.useState({store_id:1,transaction_date:R().format("YYYY-MM-DD")}),v=o=>{const r={preserveState:!0,preserveScroll:!0,only:["inventory_items"],onSuccess:e=>{j(e.props.inventory_items)}};T.get(o,[],r)},[n,b]=x.useState([{item:null,quantity:"",unitCost:""}]),C=(o,r,e)=>{const s=[...n];s[o][r]=e,b(s);const d=s[s.length-1];d.item&&d.quantity&&d.unitCost&&b([...s,{item:null,quantity:"",unitCost:""}])},N=o=>{const r=n.filter((e,s)=>s!==o);b(r.length?r:[{item:null,quantity:"",unitCost:""}])},P=()=>{if(!n.every(e=>e.item!==null&&e.quantity!==""&&e.unitCost!=="")){_.fire({title:"Error!",text:"Please fill in all the fields",icon:"error",showConfirmButton:!1,timer:2e3,timerProgressBar:!0});return}const r=new FormData;r.append("store_id",a.store_id),r.append("transaction_date",a.transaction_date),r.append("items",JSON.stringify(n)),r.append("total",n.reduce((e,s)=>e+s.unitCost*s.quantity,0)),W.post("/inventory-purchase",r).then(e=>{_.fire({title:"Success!",text:e.data.message,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),location.reload()}).catch(e=>{console.error("Submission failed with errors:",e)})};return t.jsxs(M,{children:[t.jsx(q,{title:"Inventory Purchase"}),t.jsxs(u,{container:!0,spacing:2,alignItems:"center",sx:{width:"100%"},size:12,children:[t.jsx(u,{size:3,children:t.jsx(h,{fullWidth:!0,label:"Store",variant:"outlined",select:!0,size:"large",name:"store_id",value:a.store_id,onChange:o=>c({...a,store_id:o.target.value}),children:m.map(o=>t.jsx(B,{value:o.id,children:o.name},o.id))})}),t.jsx(u,{size:3,children:t.jsx(h,{fullWidth:!0,label:"Purchase Date",variant:"outlined",name:"transaction_date",type:"date",size:"large",value:a.transaction_date,onChange:o=>c({...a,transaction_date:o.target.value}),slotProps:{inputLabel:{shrink:!0}}})}),t.jsx(u,{size:{xs:4,sm:6,md:3},children:t.jsx(I,{variant:"contained",sx:{height:"100%"},startIcon:t.jsx(w,{}),size:"large",fullWidth:!0,color:"success",onClick:()=>{p(!0)},children:"NEW INVENTORY ITEM"})})]}),t.jsx(u,{container:!0,spacing:2,sx:{mt:2},children:t.jsx(D,{component:E,sx:{mt:2},children:t.jsxs(L,{children:[t.jsx(O,{children:t.jsxs(g,{children:[t.jsx(i,{sx:{fontWeight:"bold"},children:"Inventory Item"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Unit Cost"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Quantity"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Line Total"}),t.jsx(i,{sx:{fontWeight:"bold"},children:"Action"})]})}),t.jsx(U,{children:n.map((o,r)=>t.jsxs(g,{children:[t.jsx(i,{children:t.jsx(Y,{options:f.filter(e=>!n.some((s,d)=>d!==r&&s.item?.id===e.id)||o.item?.id===e.id),getOptionLabel:e=>e.name,getOptionKey:e=>e.id,value:o.item,onChange:(e,s)=>C(r,"item",s),renderInput:e=>t.jsx(h,{...e,size:"large",fullWidth:!0})})}),t.jsx(i,{width:200,children:t.jsx(h,{fullWidth:!0,size:"large",type:"number",required:!0,placeholder:"Unit Cost",value:o.unitCost,onChange:e=>C(r,"unitCost",e.target.value)})}),t.jsx(i,{width:200,children:t.jsx(h,{fullWidth:!0,size:"large",type:"number",placeholder:"Quantity",value:o.quantity,onChange:e=>C(r,"quantity",e.target.value),required:!0,slotProps:{input:{endAdornment:t.jsx(H,{position:"end",className:"text-sm italic",children:o.item?.unit_type})}}})}),t.jsx(i,{children:t.jsxs("strong",{children:[" ",S(o.quantity*o.unitCost).format("0,0.00")]})}),t.jsx(i,{children:n.length>1&&t.jsx(V,{onClick:()=>N(r),children:t.jsx(z,{color:"error"})})})]},r))}),t.jsxs(it,{children:[t.jsxs(g,{children:[t.jsx(i,{}),t.jsx(i,{}),t.jsx(i,{align:"right",children:t.jsx("span",{className:"font-bold text-lg",children:"Total"})}),t.jsx(i,{children:t.jsx("span",{className:"font-bold text-lg",children:S(n.reduce((o,r)=>o+Number(r.quantity||0)*Number(r.unitCost||0),0)).format("0,0.00")})})]}),t.jsx(g,{children:t.jsxs(i,{align:"right",colSpan:5,children:[t.jsx(I,{variant:"contained",color:"error",onClick:()=>T.get("/inventory"),sx:{mr:2},children:"CANCEL"}),t.jsx(I,{variant:"contained",color:"primary",onClick:()=>{P()},children:"Submit"})]})})]})]})})}),t.jsx($,{className:"py-6 w-full",sx:{display:"grid",gridTemplateColumns:"1fr",height:"calc(100vh - 200px)"}}),t.jsx(A,{open:y,setOpen:p,inventory_item:null,stores:m,refreshInventoryItems:v})]})};export{We as default};
