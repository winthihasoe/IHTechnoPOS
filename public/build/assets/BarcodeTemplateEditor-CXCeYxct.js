import{r as c,j as e,b as H}from"./currencyStore-Dk9RVyyc.js";import{S as V}from"./sweetalert2.esm.all-q958Q1qq.js";import{J as me}from"./JsBarcode-DwekVVut.js";import{B as u}from"./Box-j1BTqM2v.js";import{T as d}from"./Typography-DOI0NvTt.js";import{A as K}from"./Alert-CsOnCL1T.js";import{P as q}from"./Paper-Df0ljdBt.js";import{S as Q}from"./Stack-Yyflu524.js";import{T as ee}from"./Tooltip-DjVJzg5-.js";import{I as te}from"./IconButton-PbvyX_sG.js";import{c as oe}from"./createLucideIcon-BMpC51dL.js";import{D as ue}from"./Divider-D4ysiqwk.js";import{c as $}from"./clsx-B-dksMZM.js";import{b as J,g as Y,u as X,s as D,c as Z,m as z}from"./memoTheme-BxRvtGIq.js";import{u as R}from"./useSlot-PFdYD2CN.js";import{u as xe}from"./useControlled-DRAJCB75.js";import{C as fe}from"./Collapse-CHgnjEwQ.js";import{B as he}from"./ButtonBase-CjVOrSoJ.js";import{C as G}from"./chevron-down-C5MZ1frv.js";import{G as A}from"./Grid-6qcTmjc4.js";import{T as _}from"./TextField-DpXyhoD7.js";import{C as ge}from"./Chip-DT462TV2.js";import{C as be}from"./Card-C4NAxgST.js";import{C as ye}from"./CardContent-CCQfyhgH.js";import"./useTheme-CvovRv7W.js";import"./extendSxProp-Co6nc6xJ.js";import"./index-CsFzvdgQ.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./createSvgIcon-B7q9zImx.js";import"./Close-kFSrCAJM.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./index-DM5RHFVd.js";import"./useTimeout--F2UA0HV.js";import"./useId-9XzpHYrc.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./useForkRef-DgOCCfFR.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./Grow-D31e1sMI.js";import"./Popper-pZx5Iht2.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-DuznN7Ax.js";import"./CircularProgress-B97ut0O7.js";import"./dividerClasses-BJEnnqiu.js";import"./index-Rj29YxKv.js";import"./isMuiElement-HmfyYHhb.js";import"./useFormControl-Cowmrh0y.js";import"./ownerWindow-HkKU3E4x.js";import"./debounce-Be36O1Ab.js";import"./mergeSlotProps-D_PRovB-.js";import"./Modal-D1QunwiJ.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";const re=c.createContext({});function je(o){return Y("MuiAccordion",o)}const F=J("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Ce=o=>{const{classes:r,square:s,expanded:p,disabled:m,disableGutters:x}=o;return Z({root:["root",!s&&"rounded",p&&"expanded",m&&"disabled",!x&&"gutters"],heading:["heading"],region:["region"]},je,r)},ve=D(q,{name:"MuiAccordion",slot:"Root",overridesResolver:(o,r)=>{const{ownerState:s}=o;return[{[`& .${F.region}`]:r.region},r.root,!s.square&&r.rounded,!s.disableGutters&&r.gutters]}})(z(({theme:o})=>{const r={duration:o.transitions.duration.shortest};return{position:"relative",transition:o.transitions.create(["margin"],r),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(o.vars||o).palette.divider,transition:o.transitions.create(["opacity","background-color"],r)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${F.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${F.disabled}`]:{backgroundColor:(o.vars||o).palette.action.disabledBackground}}}),z(({theme:o})=>({variants:[{props:r=>!r.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(o.vars||o).shape.borderRadius,borderTopRightRadius:(o.vars||o).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(o.vars||o).shape.borderRadius,borderBottomRightRadius:(o.vars||o).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:r=>!r.disableGutters,style:{[`&.${F.expanded}`]:{margin:"16px 0"}}}]}))),Se=D("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),we=D("div",{name:"MuiAccordion",slot:"Region"})({}),L=c.forwardRef(function(r,s){const p=X({props:r,name:"MuiAccordion"}),{children:m,className:x,defaultExpanded:f=!1,disabled:g=!1,disableGutters:j=!1,expanded:k,onChange:b,square:P=!1,slots:w={},slotProps:i={},TransitionComponent:y,TransitionProps:E,...W}=p,[l,C]=xe({controlled:k,default:f,name:"Accordion",state:"expanded"}),v=c.useCallback(pe=>{C(!l),b&&b(pe,!l)},[l,b,C]),[T,...I]=c.Children.toArray(m),B=c.useMemo(()=>({expanded:l,disabled:g,disableGutters:j,toggle:v}),[l,g,j,v]),S={...p,square:P,disabled:g,disableGutters:j,expanded:l},t=Ce(S),a={transition:y,...w},n={transition:E,...i},h={slots:a,slotProps:n},[N,se]=R("root",{elementType:ve,externalForwardedProps:{...h,...W},className:$(t.root,x),shouldForwardComponentProp:!0,ownerState:S,ref:s,additionalProps:{square:P}}),[ae,ne]=R("heading",{elementType:Se,externalForwardedProps:h,className:t.heading,ownerState:S}),[ie,le]=R("transition",{elementType:fe,externalForwardedProps:h,ownerState:S}),[ce,de]=R("region",{elementType:we,externalForwardedProps:h,ownerState:S,className:t.region,additionalProps:{"aria-labelledby":T.props.id,id:T.props["aria-controls"],role:"region"}});return e.jsxs(N,{...se,children:[e.jsx(ae,{...ne,children:e.jsx(re.Provider,{value:B,children:T})}),e.jsx(ie,{in:l,timeout:"auto",...le,children:e.jsx(ce,{...de,children:I})})]})});function Ae(o){return Y("MuiAccordionDetails",o)}J("MuiAccordionDetails",["root"]);const Pe=o=>{const{classes:r}=o;return Z({root:["root"]},Ae,r)},Te=D("div",{name:"MuiAccordionDetails",slot:"Root"})(z(({theme:o})=>({padding:o.spacing(1,2,2)}))),U=c.forwardRef(function(r,s){const p=X({props:r,name:"MuiAccordionDetails"}),{className:m,...x}=p,f=p,g=Pe(f);return e.jsx(Te,{className:$(g.root,m),ref:s,ownerState:f,...x})});function Re(o){return Y("MuiAccordionSummary",o)}const M=J("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),De=o=>{const{classes:r,expanded:s,disabled:p,disableGutters:m}=o;return Z({root:["root",s&&"expanded",p&&"disabled",!m&&"gutters"],focusVisible:["focusVisible"],content:["content",s&&"expanded",!m&&"contentGutters"],expandIconWrapper:["expandIconWrapper",s&&"expanded"]},Re,r)},ke=D(he,{name:"MuiAccordionSummary",slot:"Root"})(z(({theme:o})=>{const r={duration:o.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:o.spacing(0,2),transition:o.transitions.create(["min-height","background-color"],r),[`&.${M.focusVisible}`]:{backgroundColor:(o.vars||o).palette.action.focus},[`&.${M.disabled}`]:{opacity:(o.vars||o).palette.action.disabledOpacity},[`&:hover:not(.${M.disabled})`]:{cursor:"pointer"},variants:[{props:s=>!s.disableGutters,style:{[`&.${M.expanded}`]:{minHeight:64}}}]}})),Ee=D("span",{name:"MuiAccordionSummary",slot:"Content"})(z(({theme:o})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:r=>!r.disableGutters,style:{transition:o.transitions.create(["margin"],{duration:o.transitions.duration.shortest}),[`&.${M.expanded}`]:{margin:"20px 0"}}}]}))),We=D("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(z(({theme:o})=>({display:"flex",color:(o.vars||o).palette.action.active,transform:"rotate(0deg)",transition:o.transitions.create("transform",{duration:o.transitions.duration.shortest}),[`&.${M.expanded}`]:{transform:"rotate(180deg)"}}))),O=c.forwardRef(function(r,s){const p=X({props:r,name:"MuiAccordionSummary"}),{children:m,className:x,expandIcon:f,focusVisibleClassName:g,onClick:j,slots:k,slotProps:b,...P}=p,{disabled:w=!1,disableGutters:i,expanded:y,toggle:E}=c.useContext(re),W=n=>{E&&E(n),j&&j(n)},l={...p,expanded:y,disabled:w,disableGutters:i},C=De(l),v={slots:k,slotProps:b},[T,I]=R("root",{ref:s,shouldForwardComponentProp:!0,className:$(C.root,x),elementType:ke,externalForwardedProps:{...v,...P},ownerState:l,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:w,"aria-expanded":y,focusVisibleClassName:$(C.focusVisible,g)},getSlotProps:n=>({...n,onClick:h=>{n.onClick?.(h),W(h)}})}),[B,S]=R("content",{className:C.content,elementType:Ee,externalForwardedProps:v,ownerState:l}),[t,a]=R("expandIconWrapper",{className:C.expandIconWrapper,elementType:We,externalForwardedProps:v,ownerState:l});return e.jsxs(T,{...I,children:[e.jsx(B,{...S,children:m}),f&&e.jsx(t,{...a,children:f})]})});const Me=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ze=oe("rotate-ccw",Me);const Ie=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Be=oe("save",Ie),Ft=({settings:o})=>{const[r,s]=c.useState(""),[p,m]=c.useState(!0),[x,f]=c.useState(!1),[g,j]=c.useState(null),[k,b]=c.useState([]),[P,w]=c.useState(""),[i,y]=c.useState({format:"CODE128",width:2,height:35,fontSize:14}),E=["CODE128","EAN13","CODE39","UPC"],W=[{name:"product_name",description:"Product/item name"},{name:"price",description:"Product price"},{name:"barcode_code",description:"Barcode code/number"},{name:"store_name",description:"Store/shop name"},{name:"date",description:"Current date"}],[l,C]=c.useState({product_name:"ABC Product - XYZ",price:"1,000.00 Rs.",barcode_code:"8718719850268",store_name:"Main Store",date:new Date().toLocaleDateString()});c.useEffect(()=>{v()},[]),c.useEffect(()=>{r&&T()},[r,l,i]);const v=async()=>{try{m(!0);const t=await H.get("/api/barcode-template");s(t.data.template||""),t.data.barcode_settings&&y(t.data.barcode_settings),j(null)}catch(t){console.error("Error fetching template:",t),j("Failed to load barcode template"),s("")}finally{m(!1)}},T=async()=>{if(!r.trim()){w(""),b([]);return}try{const t=new FormData;t.append("template",btoa(r)),t.append("sample_data",JSON.stringify(l)),t.append("barcode_settings",JSON.stringify(i));const a=await H.post("/api/barcode-template/preview",t,{headers:{"Content-Type":"multipart/form-data"}});w(a.data.rendered),b([]),setTimeout(()=>{try{const n=document.getElementById("barcode-svg");n&&l.barcode_code&&me(n,l.barcode_code,{format:i.format,width:i.width,height:i.height,fontSize:i.fontSize})}catch(n){console.error("Error generating barcode:",n)}},100)}catch(t){t.response?.data?.errors?b(t.response.data.errors):b([t.message||"Error rendering preview"]),w("")}},I=async()=>{if(!r.trim()){V.fire("Warning","Template cannot be empty","warning");return}try{f(!0);const t=new FormData;t.append("template",btoa(r)),t.append("barcode_settings",JSON.stringify(i)),await H.post("/api/barcode-template",t,{headers:{"Content-Type":"multipart/form-data"}}),V.fire({title:"Success!",text:"Barcode template updated successfully",icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(t){const a=t.response?.data?.message||"Failed to save template",n=t.response?.data?.errors||[];V.fire({title:"Error",html:`
                    <div style="text-align: left;">
                        <p>${a}</p>
                        ${n.length>0?`<ul>${n.map(h=>`<li>${h}</li>`).join("")}</ul>`:""}
                    </div>
                `,icon:"error"})}finally{f(!1)}},B=(t,a)=>{C(n=>({...n,[t]:a}))},S=t=>{const a=document.getElementById("template-textarea");if(a){const n=a.selectionStart,h=a.selectionEnd,N=r.substring(0,n)+`{{${t}}}`+r.substring(h);s(N),setTimeout(()=>{a.selectionStart=a.selectionEnd=n+t.length+4,a.focus()},0)}};return p?e.jsx(u,{sx:{p:3,textAlign:"center"},children:e.jsx(d,{children:"Loading template..."})}):e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:[g&&e.jsx(K,{severity:"error",children:g}),e.jsxs(q,{elevation:2,sx:{p:3},children:[e.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(d,{variant:"h6",sx:{fontWeight:600},children:"Barcode Template Editor"}),e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(ee,{title:"Save Template",children:e.jsx(te,{size:"large",onClick:I,disabled:x,color:"success",sx:{backgroundColor:"rgba(76, 175, 80, 0.1)","&:hover":{backgroundColor:"rgba(76, 175, 80, 0.2)"}},children:e.jsx(Be,{size:24})})}),e.jsx(ee,{title:"Reset Template",children:e.jsx(te,{size:"large",onClick:v,disabled:x,color:"info",sx:{backgroundColor:"rgba(33, 150, 243, 0.1)","&:hover":{backgroundColor:"rgba(33, 150, 243, 0.2)"}},children:e.jsx(ze,{size:24})})})]})]}),e.jsx(ue,{sx:{mb:3}}),e.jsxs(L,{defaultExpanded:!0,sx:{mb:3,boxShadow:"none",border:"1px solid #e0e0e0"},children:[e.jsx(O,{expandIcon:e.jsx(G,{size:20}),children:e.jsx(d,{variant:"subtitle2",sx:{fontWeight:500},children:"Barcode Format Settings"})}),e.jsx(U,{sx:{pt:2},children:e.jsxs(A,{container:!0,spacing:2,children:[e.jsx(A,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(d,{variant:"caption",sx:{fontWeight:500,color:"#666"},children:"Format"}),e.jsx("select",{value:i.format,onChange:t=>y({...i,format:t.target.value}),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontFamily:"inherit",fontSize:"0.875rem"},children:E.map(t=>e.jsx("option",{value:t,children:t},t))})]})}),e.jsx(A,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(d,{variant:"caption",sx:{fontWeight:500,color:"#666"},children:"Width"}),e.jsx(_,{type:"number",value:i.width,onChange:t=>y({...i,width:parseFloat(t.target.value)||0}),inputProps:{step:.1,min:.5,max:10},size:"small",fullWidth:!0})]})}),e.jsx(A,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(d,{variant:"caption",sx:{fontWeight:500,color:"#666"},children:"Height"}),e.jsx(_,{type:"number",value:i.height,onChange:t=>y({...i,height:parseInt(t.target.value)||0}),inputProps:{step:1,min:10,max:200},size:"small",fullWidth:!0})]})}),e.jsx(A,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(d,{variant:"caption",sx:{fontWeight:500,color:"#666"},children:"Font Size"}),e.jsx(_,{type:"number",value:i.fontSize,onChange:t=>y({...i,fontSize:parseInt(t.target.value)||0}),inputProps:{step:1,min:8,max:32},size:"small",fullWidth:!0})]})})]})})]}),e.jsxs(A,{container:!0,spacing:3,children:[e.jsxs(A,{item:!0,xs:12,md:4,sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(u,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(d,{variant:"subtitle2",sx:{mb:1,fontWeight:500},children:"Template HTML"}),e.jsx(_,{id:"template-textarea",multiline:!0,fullWidth:!0,value:r,onChange:t=>s(t.target.value),placeholder:"Enter HTML template with {{variable}} placeholders",rows:12,sx:{fontFamily:"monospace",fontSize:"0.85rem",backgroundColor:"#f5f5f5","& .MuiOutlinedInput-input":{resize:"vertical"}},variant:"outlined"})]}),e.jsxs(u,{sx:{mt:1},children:[e.jsxs(L,{defaultExpanded:!0,sx:{boxShadow:"none",border:"1px solid #e0e0e0"},children:[e.jsx(O,{expandIcon:e.jsx(G,{size:20}),children:e.jsx(d,{variant:"subtitle2",sx:{fontWeight:500},children:"Variables (Click to Insert)"})}),e.jsx(U,{sx:{pt:1},children:e.jsx(Q,{direction:"row",spacing:1,sx:{flexWrap:"wrap",gap:1},children:W.map(t=>e.jsx(ge,{label:`{{${t.name}}}`,onClick:()=>S(t.name),color:"primary",variant:"outlined",size:"small",sx:{cursor:"pointer"},title:t.description},t.name))})})]}),e.jsxs(L,{sx:{boxShadow:"none",border:"1px solid #e0e0e0",mt:1},children:[e.jsx(O,{expandIcon:e.jsx(G,{size:20}),children:e.jsx(d,{variant:"subtitle2",sx:{fontWeight:500},children:"Sample Data for Preview"})}),e.jsx(U,{sx:{pt:1},children:e.jsx(u,{sx:{display:"flex",flexDirection:"column",gap:1,width:"100%"},children:W.map(t=>e.jsx(_,{size:"small",label:t.name.replace(/_/g," ").toUpperCase(),value:l[t.name]||"",onChange:a=>B(t.name,a.target.value),placeholder:`{{${t.name}}}`,fullWidth:!0},t.name))})})]})]})]}),e.jsxs(A,{item:!0,xs:12,md:8,sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(d,{variant:"subtitle2",sx:{fontWeight:500},children:"Live Preview"}),k.length>0&&e.jsx(K,{severity:"error",sx:{mb:1,py:.5},children:e.jsx("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"0.8rem"},children:k.map((t,a)=>e.jsx("li",{children:t},a))})}),e.jsx(be,{sx:{backgroundColor:"#fafafa",display:"flex",flexDirection:"column",maxHeight:"600px"},children:e.jsx(ye,{sx:{overflowY:"auto",p:2,display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:P?e.jsx(u,{sx:{p:2,backgroundColor:"white",border:"1px solid #e0e0e0",borderRadius:"4px",width:"100%",maxWidth:"320px",fontFamily:o.sale_print_font||"Arial, sans-serif"},dangerouslySetInnerHTML:{__html:P}}):e.jsx(u,{sx:{p:2,backgroundColor:"white",border:"1px dashed #cccccc",borderRadius:"4px",width:"100%",maxWidth:"320px",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",textAlign:"center",minHeight:"300px"},children:e.jsx(d,{variant:"body2",children:"Enter template on the left to see preview"})})})})]})]})]}),e.jsxs(q,{elevation:1,sx:{p:2,backgroundColor:"#f0f7ff",border:"1px solid #b3d9ff"},children:[e.jsx(d,{variant:"subtitle2",sx:{mb:1,fontWeight:500,color:"#0066cc"},children:"ðŸ’¡ Template Tips"}),e.jsx(d,{variant:"body2",sx:{mb:.5,fontSize:"0.9rem"},children:"â€¢ Use HTML and CSS to structure your barcode template"}),e.jsxs(d,{variant:"body2",sx:{mb:.5,fontSize:"0.9rem"},children:["â€¢ Insert variables using double curly braces: ",e.jsx("code",{children:"{{variable_name}}"})]}),e.jsxs(d,{variant:"body2",sx:{mb:.5,fontSize:"0.9rem"},children:["â€¢ For barcodes, create an SVG element with ",e.jsx("code",{children:'id="barcode-svg"'})]}),e.jsx(d,{variant:"body2",sx:{fontSize:"0.9rem"},children:"â€¢ Click any variable chip on the left to insert it into your template"})]})]})};export{Ft as default};
