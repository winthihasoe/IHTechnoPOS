import{r as h,j as o,R as $e,d as Le,H as Ae,a as De}from"./currencyStore-Dk9RVyyc.js";import{A as Re}from"./AuthenticatedLayout-CblcNqH9.js";import"./en-gb-BMmXCQZs.js";import{S as fe}from"./sweetalert2.esm.all-q958Q1qq.js";import{p as V}from"./index-P4sNTowN.js";import{S as Pe}from"./react-select.esm-Cy0FGMM3.js";import{i as We}from"./browser-image-compression-DILJcqf6.js";import{S as Ue}from"./Save-CaF6Qy7H.js";import{A as Ie}from"./Add-5ZpxTNJx.js";import{A as Fe}from"./ArrowBackIosNew-DODCClIX.js";import{p as Y}from"./product-placeholder-DL4NWfZp.js";import qe from"./BatchesTable-DGAF_1dU.js";import he from"./CollectionSelector-DXMNVyb9.js";import{G as w}from"./Grid-6qcTmjc4.js";import{T as z}from"./TextField-DpXyhoD7.js";import{M as F}from"./MenuItem-CEIQJ6q4.js";import{L as Ge,A as Ve}from"./useMobilePicker-BIozrTWd.js";import{D as Ye}from"./DatePicker--Uxs9Qj-.js";import{B as He}from"./Box-j1BTqM2v.js";import{B as ee}from"./Button-aMjmD1gp.js";import{c as xe}from"./clsx-B-dksMZM.js";import{b as be,g as ve,e as Xe,u as Ce,s as le,f as se,c as je,m as we}from"./memoTheme-BxRvtGIq.js";import{c as Qe}from"./createSimplePaletteValueFilter-bm0fmN_7.js";import{B as Je}from"./ButtonBase-CjVOrSoJ.js";import{C as Ze}from"./CardMedia-lO_mnymB.js";import{C as et}from"./CardActions-BO7B2VgV.js";import{U as tt}from"./upload-cVSUPpRP.js";import{I as ot}from"./IconButton-PbvyX_sG.js";import{T as st}from"./trash-2-CD_MqfHw.js";import{A as rt}from"./Autocomplete-DfOnEm4b.js";import{A as it}from"./AppBar-CxLpgr4B.js";import{T as nt}from"./Toolbar-f3-_dlD0.js";import"./createSvgIcon-B7q9zImx.js";import"./Payments-DSgOMdsa.js";import"./Receipt-DnWIM4Bg.js";import"./index-RHigu7j0.js";import"./index-NgBaJJmW.js";import"./infoshop-hkdJrh2a.js";import"./Divider-D4ysiqwk.js";import"./dividerClasses-BJEnnqiu.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./ListItemButton-DDnSs3En.js";import"./listItemButtonClasses-DXPtGUcW.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./useForkRef-DgOCCfFR.js";import"./listItemIconClasses-vD-ryqxg.js";import"./ListItemText--0XI93dL.js";import"./listItemTextClasses-DNpdtY9T.js";import"./useSlot-PFdYD2CN.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./useTheme-CvovRv7W.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./extendSxProp-Co6nc6xJ.js";import"./Collapse-CHgnjEwQ.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./useTimeout--F2UA0HV.js";import"./CssBaseline-DBisayGl.js";import"./Tooltip-DjVJzg5-.js";import"./index-DM5RHFVd.js";import"./useControlled-DRAJCB75.js";import"./useId-9XzpHYrc.js";import"./Grow-D31e1sMI.js";import"./Popper-pZx5Iht2.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-DuznN7Ax.js";import"./Drawer-Dk2A_cxp.js";import"./mergeSlotProps-D_PRovB-.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-HkKU3E4x.js";import"./Modal-D1QunwiJ.js";import"./Paper-Df0ljdBt.js";import"./ListItem-BK8RisGy.js";import"./isMuiElement-HmfyYHhb.js";import"./Select-ef7c0426.esm-CXaJakO2.js";import"./toPropertyKey-C9c9JG92.js";import"./floating-ui.dom-CpMS8hwT.js";import"./BatchModal-COABRYv3.js";import"./Close-B9rgBTOR.js";import"./DialogContent-Cz4a0t2H.js";import"./DialogTitle-osZsMdGC.js";import"./FormControlLabel-eGygXIaI.js";import"./useFormControl-Cowmrh0y.js";import"./Switch-DzXzblLj.js";import"./SwitchBase-DLVdjlNh.js";import"./DialogActions-BraO_KzF.js";import"./index-Rj29YxKv.js";import"./CircularProgress-B97ut0O7.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./createLucideIcon-BMpC51dL.js";import"./QuickAddCollectionDialog-Dd-PIe21.js";import"./Alert-CsOnCL1T.js";import"./Close-kFSrCAJM.js";import"./usePreviousProps-Dg0VAGfT.js";import"./Chip-DT462TV2.js";import"./InputAdornment-DZOHCUsF.js";import"./index-JJ5bZ37u.js";function at(e){return h.Children.toArray(e).filter(t=>h.isValidElement(t))}function lt(e){return ve("MuiToggleButton",e)}const q=be("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),_e=h.createContext({}),Be=h.createContext(void 0);function ct(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}const dt=e=>{const{classes:t,fullWidth:s,selected:r,disabled:i,size:a,color:c}=e,n={root:["root",r&&"selected",i&&"disabled",s&&"fullWidth",`size${se(a)}`,c]};return je(n,lt,t)},ut=le(Je,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[`size${se(s.size)}`]]}})(we(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${q.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${q.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(Qe()).map(([t])=>({props:{color:t},style:{[`&.${q.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),pt=h.forwardRef(function(t,s){const{value:r,...i}=h.useContext(_e),a=h.useContext(Be),c=Xe({...i,selected:ct(t.value,r)},t),n=Ce({props:c,name:"MuiToggleButton"}),{children:y,className:b,color:x="standard",disabled:v=!1,disableFocusRipple:j=!1,fullWidth:d=!1,onChange:K,onClick:k,selected:N,size:D="medium",value:$,...W}=n,R={...n,color:x,disabled:v,disableFocusRipple:j,fullWidth:d,size:D},G=dt(R),u=C=>{k&&(k(C,$),C.defaultPrevented)||K&&K(C,$)},S=a||"";return o.jsx(ut,{className:xe(i.className,G.root,b,S),disabled:v,focusRipple:!j,ref:s,onClick:u,onChange:K,value:$,ownerState:R,"aria-pressed":N,...W,children:y})});function mt(e){return ve("MuiToggleButtonGroup",e)}const p=be("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),ft=e=>{const{classes:t,orientation:s,fullWidth:r,disabled:i}=e,a={root:["root",s,r&&"fullWidth"],grouped:["grouped",`grouped${se(s)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return je(a,mt,t)},ht=le("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[{[`& .${p.grouped}`]:t.grouped},{[`& .${p.grouped}`]:t[`grouped${se(s.orientation)}`]},{[`& .${p.firstButton}`]:t.firstButton},{[`& .${p.lastButton}`]:t.lastButton},{[`& .${p.middleButton}`]:t.middleButton},t.root,s.orientation==="vertical"&&t.vertical,s.fullWidth&&t.fullWidth]}})(we(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${p.grouped}`]:{[`&.${p.selected} + .${p.grouped}.${p.selected}`]:{borderTop:0,marginTop:0}},[`& .${p.firstButton},& .${p.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${p.lastButton},& .${p.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${p.lastButton}.${q.disabled},& .${p.middleButton}.${q.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${p.grouped}`]:{[`&.${p.selected} + .${p.grouped}.${p.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${p.firstButton},& .${p.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${p.lastButton},& .${p.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${p.lastButton}.${q.disabled},& .${p.middleButton}.${q.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),gt=h.forwardRef(function(t,s){const r=Ce({props:t,name:"MuiToggleButtonGroup"}),{children:i,className:a,color:c="standard",disabled:n=!1,exclusive:y=!1,fullWidth:b=!1,onChange:x,orientation:v="horizontal",size:j="medium",value:d,...K}=r,k={...r,disabled:n,fullWidth:b,orientation:v,size:j},N=ft(k),D=h.useCallback((S,C)=>{if(!x)return;const P=d&&d.indexOf(C);let U;d&&P>=0?(U=d.slice(),U.splice(P,1)):U=d?d.concat(C):[C],x(S,U)},[x,d]),$=h.useCallback((S,C)=>{x&&x(S,d===C?null:C)},[x,d]),W=h.useMemo(()=>({className:N.grouped,onChange:y?$:D,value:d,size:j,fullWidth:b,color:c,disabled:n}),[N.grouped,y,$,D,d,j,b,c,n]),R=at(i),G=R.length,u=S=>{const C=S===0,P=S===G-1;return C&&P?"":C?N.firstButton:P?N.lastButton:N.middleButton};return o.jsx(ht,{role:"group",className:xe(N.root,a),ref:s,ownerState:k,...K,children:o.jsx(_e.Provider,{value:W,children:R.map((S,C)=>o.jsx(Be.Provider,{value:u(C),children:S},C))})})}),ie=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function ne(e,t,s,r){e.addEventListener?e.addEventListener(t,s,r):e.attachEvent&&e.attachEvent("on".concat(t),s)}function H(e,t,s,r){e.removeEventListener?e.removeEventListener(t,s,r):e.detachEvent&&e.detachEvent("on".concat(t),s)}function ke(e,t){const s=t.slice(0,t.length-1);for(let r=0;r<s.length;r++)s[r]=e[s[r].toLowerCase()];return s}function Se(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let s=t.lastIndexOf("");for(;s>=0;)t[s-1]+=",",t.splice(s,1),s=t.lastIndexOf("");return t}function yt(e,t){const s=e.length>=t.length?e:t,r=e.length>=t.length?t:e;let i=!0;for(let a=0;a<s.length;a++)r.indexOf(s[a])===-1&&(i=!1);return i}const Q={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":ie?173:189,"=":ie?61:187,";":ie?59:186,"'":222,"[":219,"]":221,"\\":220},M={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},oe={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},B={16:!1,18:!1,17:!1,91:!1},g={};for(let e=1;e<20;e++)Q["f".concat(e)]=111+e;let f=[],X=null,ze="all";const A=new Map,Z=e=>Q[e.toLowerCase()]||M[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),xt=e=>Object.keys(Q).find(t=>Q[t]===e),bt=e=>Object.keys(M).find(t=>M[t]===e);function Ke(e){ze=e||"all"}function J(){return ze||"all"}function vt(){return f.slice(0)}function Ct(){return f.map(e=>xt(e)||bt(e)||String.fromCharCode(e))}function jt(){const e=[];return Object.keys(g).forEach(t=>{g[t].forEach(s=>{let{key:r,scope:i,mods:a,shortcut:c}=s;e.push({scope:i,shortcut:c,mods:a,keys:r.split("+").map(n=>Z(n))})})}),e}function wt(e){const t=e.target||e.srcElement,{tagName:s}=t;let r=!0;const i=s==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(i||s==="TEXTAREA"||s==="SELECT")&&!t.readOnly)&&(r=!1),r}function _t(e){return typeof e=="string"&&(e=Z(e)),f.indexOf(e)!==-1}function Bt(e,t){let s,r;e||(e=J());for(const i in g)if(Object.prototype.hasOwnProperty.call(g,i))for(s=g[i],r=0;r<s.length;)s[r].scope===e?s.splice(r,1).forEach(c=>{let{element:n}=c;return ce(n)}):r++;J()===e&&Ke(t||"all")}function kt(e){let t=e.keyCode||e.which||e.charCode;const s=f.indexOf(t);if(s>=0&&f.splice(s,1),e.key&&e.key.toLowerCase()==="meta"&&f.splice(0,f.length),(t===93||t===224)&&(t=91),t in B){B[t]=!1;for(const r in M)M[r]===t&&(O[r]=!1)}}function Ee(e){if(typeof e>"u")Object.keys(g).forEach(i=>{Array.isArray(g[i])&&g[i].forEach(a=>te(a)),delete g[i]}),ce(null);else if(Array.isArray(e))e.forEach(i=>{i.key&&te(i)});else if(typeof e=="object")e.key&&te(e);else if(typeof e=="string"){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];let[i,a]=s;typeof i=="function"&&(a=i,i=""),te({key:e,scope:i,method:a,splitKey:"+"})}}const te=e=>{let{key:t,scope:s,method:r,splitKey:i="+"}=e;Se(t).forEach(c=>{const n=c.split(i),y=n.length,b=n[y-1],x=b==="*"?"*":Z(b);if(!g[x])return;s||(s=J());const v=y>1?ke(M,n):[],j=[];g[x]=g[x].filter(d=>{const k=(r?d.method===r:!0)&&d.scope===s&&yt(d.mods,v);return k&&j.push(d.element),!k}),j.forEach(d=>ce(d))})};function ge(e,t,s,r){if(t.element!==r)return;let i;if(t.scope===s||t.scope==="all"){i=t.mods.length>0;for(const a in B)Object.prototype.hasOwnProperty.call(B,a)&&(!B[a]&&t.mods.indexOf(+a)>-1||B[a]&&t.mods.indexOf(+a)===-1)&&(i=!1);(t.mods.length===0&&!B[16]&&!B[18]&&!B[17]&&!B[91]||i||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(f),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function ye(e,t){const s=g["*"];let r=e.keyCode||e.which||e.charCode;if(!O.filter.call(this,e))return;if((r===93||r===224)&&(r=91),f.indexOf(r)===-1&&r!==229&&f.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(n=>{const y=oe[n];e[n]&&f.indexOf(y)===-1?f.push(y):!e[n]&&f.indexOf(y)>-1?f.splice(f.indexOf(y),1):n==="metaKey"&&e[n]&&(f=f.filter(b=>b in oe||b===r))}),r in B){B[r]=!0;for(const n in M)M[n]===r&&(O[n]=!0);if(!s)return}for(const n in B)Object.prototype.hasOwnProperty.call(B,n)&&(B[n]=e[oe[n]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(f.indexOf(17)===-1&&f.push(17),f.indexOf(18)===-1&&f.push(18),B[17]=!0,B[18]=!0);const i=J();if(s)for(let n=0;n<s.length;n++)s[n].scope===i&&(e.type==="keydown"&&s[n].keydown||e.type==="keyup"&&s[n].keyup)&&ge(e,s[n],i,t);if(!(r in g))return;const a=g[r],c=a.length;for(let n=0;n<c;n++)if((e.type==="keydown"&&a[n].keydown||e.type==="keyup"&&a[n].keyup)&&a[n].key){const y=a[n],{splitKey:b}=y,x=y.key.split(b),v=[];for(let j=0;j<x.length;j++)v.push(Z(x[j]));v.sort().join("")===f.sort().join("")&&ge(e,y,i,t)}}function O(e,t,s){f=[];const r=Se(e);let i=[],a="all",c=document,n=0,y=!1,b=!0,x="+",v=!1,j=!1;for(s===void 0&&typeof t=="function"&&(s=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(a=t.scope),t.element&&(c=t.element),t.keyup&&(y=t.keyup),t.keydown!==void 0&&(b=t.keydown),t.capture!==void 0&&(v=t.capture),typeof t.splitKey=="string"&&(x=t.splitKey),t.single===!0&&(j=!0)),typeof t=="string"&&(a=t),j&&Ee(e,a);n<r.length;n++)e=r[n].split(x),i=[],e.length>1&&(i=ke(M,e)),e=e[e.length-1],e=e==="*"?"*":Z(e),e in g||(g[e]=[]),g[e].push({keyup:y,keydown:b,scope:a,mods:i,shortcut:r[n],method:s,key:r[n],splitKey:x,element:c});if(typeof c<"u"&&window){if(!A.has(c)){const d=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return ye(k,c)},K=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;ye(k,c),kt(k)};A.set(c,{keydownListener:d,keyupListenr:K,capture:v}),ne(c,"keydown",d,v),ne(c,"keyup",K,v)}if(!X){const d=()=>{f=[]};X={listener:d,capture:v},ne(window,"focus",d,v)}}}function St(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(g).forEach(s=>{g[s].filter(i=>i.scope===t&&i.shortcut===e).forEach(i=>{i&&i.method&&i.method()})})}function ce(e){const t=Object.values(g).flat();if(t.findIndex(r=>{let{element:i}=r;return i===e})<0){const{keydownListener:r,keyupListenr:i,capture:a}=A.get(e)||{};r&&i&&(H(e,"keyup",i,a),H(e,"keydown",r,a),A.delete(e))}if((t.length<=0||A.size<=0)&&(Object.keys(A).forEach(i=>{const{keydownListener:a,keyupListenr:c,capture:n}=A.get(i)||{};a&&c&&(H(i,"keyup",c,n),H(i,"keydown",a,n),A.delete(i))}),A.clear(),Object.keys(g).forEach(i=>delete g[i]),X)){const{listener:i,capture:a}=X;H(window,"focus",i,a),X=null}}const ae={getPressedKeyString:Ct,setScope:Ke,getScope:J,deleteScope:Bt,getPressedKeyCodes:vt,getAllKeyCodes:jt,isPressed:_t,filter:wt,trigger:St,unbind:Ee,keyMap:Q,modifier:M,modifierMap:oe};for(const e in ae)Object.prototype.hasOwnProperty.call(ae,e)&&(O[e]=ae[e]);if(typeof window<"u"){const e=window.hotkeys;O.noConflict=t=>(t&&window.hotkeys===O&&(window.hotkeys=e),O),window.hotkeys=O}class de extends $e.Component{constructor(t){super(t),this.isKeyDown=!1,this.handle=void 0,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.handleKeyUpEvent=this.handleKeyUpEvent.bind(this),this.handle={}}componentDidMount(){var{filter:t,splitKey:s}=this.props;t&&(O.filter=t),O.unbind(this.props.keyName),O(this.props.keyName,{splitKey:s},this.onKeyDown),document&&document.body.addEventListener("keyup",this.handleKeyUpEvent)}componentWillUnmount(){O.unbind(this.props.keyName),this.isKeyDown=!0,this.handle={},document&&document.body.removeEventListener("keyup",this.handleKeyUpEvent)}onKeyUp(t,s){var{onKeyUp:r,disabled:i}=this.props;!i&&r&&r(s.shortcut,t,s)}onKeyDown(t,s){var{onKeyDown:r,allowRepeat:i,disabled:a}=this.props;this.isKeyDown&&!i||(this.isKeyDown=!0,this.handle=s,!a&&r&&r(s.shortcut,t,s))}handleKeyUpEvent(t){this.isKeyDown&&(this.isKeyDown=!1,!(this.props.keyName&&this.props.keyName.indexOf(this.handle.shortcut)<0)&&(this.onKeyUp(t,this.handle),this.handle={}))}render(){return this.props.children||null}}de.defaultProps={filter(e){var t=e.target||e.srcElement,s=t.tagName;return!(t.isContentEditable||s==="INPUT"||s==="SELECT"||s==="TEXTAREA")}};de.propTypes={keyName:V.string,filter:V.func,onKeyDown:V.func,onKeyUp:V.func,disabled:V.bool,splitKey:V.string};const zt=le("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function js({product:e,collection:t,product_code:s,contacts:r,product_alert:i,misc_setting:a}){const[c,n]=h.useState("percentage"),[y,b]=h.useState(!1),[x,v]=h.useState(null),[j,d]=h.useState(e?.batches||[]),[K,k]=h.useState(t||[]),N=10*1024*1024,D=K.filter(l=>l.collection_type==="brand").map(({id:l,name:m})=>({id:l,label:m})),[$,W]=h.useState("1"),[R,G]=h.useState(D.find(l=>l.id===null)||null),[u,S]=h.useState({name:"",description:"",sku:"",barcode:s,featured_image:Y,unit:"PC",quantity:"",alert_quantity:i,is_stock_managed:1,is_active:1,brand_id:"",product_type:"simple",fixed_commission:0,batch_number:Le().format("DDMMYYYY"),discount:0,discount_percentage:0,price:"",delete_image:0,collection_ids:[]}),[C,P]=h.useState([]),[U,ue]=h.useState([]),E=l=>{const{name:m,value:T,type:_,checked:I}=l.target,L={...u,[m]:_==="checkbox"?I:T};m==="discount_percentage"?(L.discount="0",L.discount_percentage=T):m==="discount"&&(L.discount_percentage="0"),S(L)},Te=async l=>{const m=l.target.files[0];if(m&&m.size>N){alert("File size exceeds the 2MB limit.");return}if(m)try{const T={maxSizeMB:a&&a.optimize_image_size||.5,maxWidthOrHeight:a&&a.optimize_image_width||720,useWebWorker:!0},_=await We(m,T);v(_);const I=new FileReader;I.onloadend=()=>{S({...u,featured_image:I.result,delete_image:0})},I.readAsDataURL(_)}catch(T){console.error("Error compressing the image:",T)}};h.useEffect(()=>{if(e&&(S({name:e.name,description:e.description||"",sku:e.sku||"",barcode:e.barcode||"",featured_image:e.image_url?e.image_url:Y,unit:e.unit||"PC",alert_quantity:e.alert_quantity||0,is_stock_managed:e.is_stock_managed||!1,is_active:e.is_active||!1,brand_id:e.brand_id||"",category_id:e.category_id||"",product_type:e.product_type||"simple",fixed_commission:e.fixed_commission||0}),W(e.is_stock_managed.toString()),G(D.find(l=>l.id===e.brand_id)),e.collection_ids&&Array.isArray(e.collection_ids))){const l=t.filter(_=>e.collection_ids.includes(_.id)).map(_=>({id:_.id,label:_.name,collection_type:_.collection_type})),m=l.filter(_=>_.collection_type==="category"),T=l.filter(_=>_.collection_type==="tag");P(m),ue(T)}},[e]);const pe=h.useRef(null);h.useEffect(()=>{pe.current.focus()},[]);const Oe=(l,m)=>{W(m?"1":"0")},Ne=()=>{},me=l=>{k(m=>[...m,l])},Me=l=>{if(l.preventDefault(),y)return;b(!0);const m=new FormData(l.currentTarget);x&&m.append("featured_image",x);const T=Object.fromEntries(m.entries());T.brand_id=R?.id??"",T.delete_image=u.delete_image;const _=[...C,...U];_.length>0&&_.forEach((L,re)=>{T[`collection_ids[${re}]`]=L.id});const I=e?`/products/${e.id}`:"/products";De.post(I,T,{forceFormData:!0,onSuccess:L=>{fe.fire({title:"Success!",text:"Successfully saved",icon:"success",position:"bottom-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,toast:!0}),b(!1)},onError:L=>{const re=Object.values(L).flat().join(" | ");fe.fire({title:"Error!",text:re||"An unexpected error occurred.",icon:"error",confirmButtonText:"OK"}),b(!1)}})};return o.jsx(Re,{children:o.jsxs(de,{keyName:"Control+s",onKeyDown:(l,m)=>{m.preventDefault(),l==="Control+s"&&document.getElementById("product-form").requestSubmit()},children:[o.jsx(Ae,{title:"Products"}),o.jsxs("form",{id:"product-form",encType:"multipart/form-data",onSubmit:Me,children:[o.jsx("input",{name:"is_stock_managed",type:"hidden",value:$}),o.jsx("div",{className:"max-w-5xl mx-auto pb-24",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"General Information"})}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs(w,{container:!0,spacing:2,children:[o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Barcode",id:"barcode",name:"barcode",fullWidth:!0,required:!0,value:u.barcode,onChange:E,autoFocus:!0,ref:pe,onFocus:l=>{l.target.select()}})}),o.jsx(w,{size:{xs:12,sm:8},children:o.jsx(z,{size:"small",label:"Product Name",name:"name",fullWidth:!0,required:!0,value:u.name,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsxs(z,{size:"small",value:u.unit,label:"Product Unit",onChange:E,name:"unit",select:!0,fullWidth:!0,children:[o.jsx(F,{value:"PC",children:"PC"}),o.jsx(F,{value:"KG",children:"KG"}),o.jsx(F,{value:"Meter",children:"Meter"})]})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsxs(z,{size:"small",label:"Product Type",name:"product_type",select:!0,fullWidth:!0,onChange:E,value:u.product_type,required:!0,children:[o.jsx(F,{value:"simple",children:"SIMPLE"}),o.jsx(F,{value:"reload",children:"RELOAD"}),o.jsx(F,{value:"commission",children:"COMMISSION"}),o.jsx(F,{value:"custom",children:"CUSTOM"})]})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Alert Quantity",id:"alert-quantity",name:"alert_quantity",type:"number",fullWidth:!0,onChange:E,value:u.alert_quantity})}),(u.product_type==="reload"||u.product_type==="commission")&&o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:u.product_type==="reload"?"Commission (%)":"Fixed Commission",name:"fixed_commission",type:"number",fullWidth:!0,required:!0,onChange:E,value:u.fixed_commission})})]})})]}),!e&&o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Stock"})}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs(w,{container:!0,spacing:2,children:[o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Cost",name:"cost",type:"number",fullWidth:!0,required:!0,step:.5,value:u.cost,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Price",name:"price",type:"number",fullWidth:!0,required:!0,value:u.price,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Quantity",name:"quantity",type:"number",fullWidth:!0,required:!0,step:.5,value:u.quantity,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Discount %",name:"discount_percentage",type:"number",fullWidth:!0,value:u.discount_percentage,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Flat Discount",name:"discount",type:"number",fullWidth:!0,value:u.discount,onChange:E})}),o.jsx(w,{size:{xs:12,sm:4},children:o.jsx(z,{size:"small",label:"Batch #",name:"batch_number",fullWidth:!0,value:u.batch_number,onChange:E})}),o.jsx(w,{size:{xs:12,sm:12},children:o.jsx(Ge,{dateAdapter:Ve,adapterLocale:"en-gb",children:o.jsx(Ye,{name:"expiry_date",label:"Expiry Date",className:"w-full",format:"YYYY-MM-DD",slotProps:{textField:{size:"small"}}})})})]})})]}),e&&o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Batches"}),o.jsx(He,{onClick:()=>document.querySelector("[data-batch-modal-trigger]")?.click(),children:o.jsx(ee,{variant:"contained",color:"success",size:"small",startIcon:o.jsx(Ie,{}),children:"Add Batch"})})]}),o.jsx("div",{className:"p-4",children:o.jsx(qe,{product:e,batches:j,contacts:r,onBatchesChange:Ne})})]}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Description"})}),o.jsx("div",{className:"px-6 py-5",children:o.jsx(z,{size:"small",label:"Product Description",id:"product-description",name:"description",fullWidth:!0,multiline:!0,rows:4,value:u.description,onChange:E})})]})]}),o.jsx("div",{className:"lg:col-span-1",children:o.jsx("div",{className:"sticky top-4",children:o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:o.jsx(gt,{color:"primary",value:$,exclusive:!0,onChange:Oe,"aria-label":"Manage stock",id:"btn-manage-stock",variant:"contained",fullWidth:!0,size:"small",children:o.jsx(pt,{value:"1",sx:{color:"black","&.Mui-selected":{bgcolor:"success.dark",color:"white","&:hover":{bgcolor:"success.dark"}}},variant:"contained",children:"Manage Stock"})})}),o.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[o.jsx(Ze,{sx:{height:{xs:200,sm:240}},image:u.featured_image??Y}),o.jsxs(et,{className:"p-3 flex gap-2",children:[o.jsxs(ee,{component:"label",role:void 0,variant:"contained",size:"small",tabIndex:-1,startIcon:o.jsx(tt,{size:18}),fullWidth:!0,sx:{textTransform:"none",fontWeight:500},children:["Upload",o.jsx(zt,{type:"file",accept:"image/*",onChange:Te,name:"featured_image"})]}),u.featured_image&&u.featured_image!==Y&&o.jsx(ot,{size:"small",onClick:()=>{S({...u,featured_image:Y,delete_image:1});const l=document.querySelector('input[name="featured_image"]');l&&(l.value=""),v(null)},sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"}},children:o.jsx(st,{size:18})})]})]}),o.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:o.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"More Information"})}),o.jsxs("div",{className:"px-6 py-5 space-y-4",children:[!e&&o.jsx(Pe,{className:"w-full",placeholder:"Select a supplier...",name:"contact_id",styles:{control:(l,m)=>({...l,height:"40px"})},options:r,isClearable:!0,getOptionLabel:l=>l.name,getOptionValue:l=>l.id}),o.jsx(rt,{size:"small",disablePortal:!0,value:R||null,onChange:(l,m)=>{G(m)},getOptionLabel:l=>l.label,options:D,fullWidth:!0,id:"brand",renderInput:l=>o.jsx(z,{...l,label:"Brand",size:"small"})}),o.jsx(he,{collections:K,selectedCollections:C,onCollectionChange:P,onCollectionCreated:me,collectionType:"category",label:"Categories",placeholder:"Select categories..."}),o.jsx(he,{collections:K,selectedCollections:U,onCollectionChange:ue,onCollectionCreated:me,collectionType:"tag",label:"Tags",placeholder:"Select tags..."})]})]})})})]})}),o.jsx(it,{position:"fixed",variant:"contained",sx:{top:"auto",bottom:0},children:o.jsx(nt,{children:o.jsxs(w,{container:!0,justifyContent:"flex-end",size:12,width:"100%",spacing:2,children:[o.jsx(w,{size:{xs:6,sm:2},children:o.jsx(ee,{fullWidth:!0,variant:"contained",color:"warning",size:"large",startIcon:o.jsx(Fe,{}),sx:{mr:"1rem"},onClick:()=>window.history.back(),children:"BACK"})}),o.jsx(w,{size:{xs:6,sm:2},children:o.jsx(ee,{fullWidth:!0,variant:"contained",type:"submit",color:"success",size:"large",endIcon:o.jsx(Ue,{}),disabled:y,children:"SAVE"})})]})})})]})]})})}export{js as default};
