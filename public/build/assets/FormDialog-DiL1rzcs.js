import{c as O,r as s,j as e,a as P}from"./currencyStore-Dk9RVyyc.js";import{S as y}from"./sweetalert2.esm.all-q958Q1qq.js";import{D as F,a as I}from"./DialogContent-Cz4a0t2H.js";import{D as N}from"./DialogTitle-osZsMdGC.js";import{G as m}from"./Grid-6qcTmjc4.js";import{T as u}from"./TextField-DpXyhoD7.js";import{M as l}from"./MenuItem-CEIQJ6q4.js";import{D as W}from"./DialogActions-BraO_KzF.js";import{B as C}from"./Button-aMjmD1gp.js";import"./clsx-B-dksMZM.js";import"./memoTheme-BxRvtGIq.js";import"./index-Rj29YxKv.js";import"./useTheme-CvovRv7W.js";import"./useSlot-PFdYD2CN.js";import"./useForkRef-DgOCCfFR.js";import"./Paper-Df0ljdBt.js";import"./Modal-D1QunwiJ.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./TransitionGroupContext-yQ7B3b2o.js";import"./Portal-DeuEDNNi.js";import"./index-DJHI8khq.js";import"./useId-9XzpHYrc.js";import"./Typography-DOI0NvTt.js";import"./index-CsFzvdgQ.js";import"./emotion-react.browser.esm-BdOGWTdw.js";import"./extendSxProp-Co6nc6xJ.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./useThemeProps-Cgy5Iu59.js";import"./getThemeProps-DKKyYQML.js";import"./isMuiElement-HmfyYHhb.js";import"./useFormControl-Cowmrh0y.js";import"./debounce-Be36O1Ab.js";import"./index-DM5RHFVd.js";import"./useSlotProps-DuznN7Ax.js";import"./Grow-D31e1sMI.js";import"./useTimeout--F2UA0HV.js";import"./mergeSlotProps-D_PRovB-.js";import"./List-OrinuOpJ.js";import"./ListContext-CTnR0k9S.js";import"./useControlled-DRAJCB75.js";import"./createSvgIcon-B7q9zImx.js";import"./ButtonBase-CjVOrSoJ.js";import"./listItemIconClasses-vD-ryqxg.js";import"./listItemTextClasses-DNpdtY9T.js";import"./dividerClasses-BJEnnqiu.js";import"./CircularProgress-B97ut0O7.js";function Oe({open:b,handleClose:d,collection:i}){const{allCollections:h}=O().props,[D,f]=s.useState(""),[v,g]=s.useState("category"),[S,x]=s.useState(""),[T,p]=s.useState("");s.useEffect(()=>{i?(f(i.name||""),g(i.collection_type||"category"),x(i.description||""),p(i.parent_id||"")):(f(""),g("category"),x(""),p(""))},[i]);const E=t=>{t.preventDefault();const n=new FormData(t.currentTarget),c=Object.fromEntries(n.entries()),r=i?`/collection/${i.id}`:"/collection";P["post"](r,c,{onSuccess:a=>{y.fire({title:"Success!",text:"Successfully saved",icon:"success",position:"bottom-start",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,toast:!0}),d()},onError:a=>{const o=Object.values(a).flat().join(" | ");y.fire({title:"Error!",text:o||"An unexpected error occurred.",icon:"error",confirmButtonText:"OK"})}})},B=t=>{const n=t.target.value;g(n),n!=="category"&&p("")},_=(()=>{if(!h)return[];const t={},n=[];h.forEach(r=>{t[r.id]={...r,children:[]}}),h.forEach(r=>{r.parent_id&&t[r.parent_id]?t[r.parent_id].children.push(t[r.id]):n.push(t[r.id])});const c=(r,j=0)=>{let a=[];return r.forEach(o=>{i&&o.id===i.id||(a.push({id:o.id,name:o.name,level:j}),o.children&&o.children.length>0&&(a=a.concat(c(o.children,j+1))))}),a};return c(n)})();return e.jsx(e.Fragment,{children:e.jsxs(F,{open:b,onClose:d,PaperProps:{component:"form",onSubmit:E},children:[e.jsx(N,{children:"Collection Information"}),e.jsx(I,{children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{size:12,children:e.jsx(u,{autoFocus:!0,required:!0,margin:"dense",name:"name",label:"Collection Name",type:"text",fullWidth:!0,variant:"outlined",value:D,onChange:t=>f(t.target.value)})}),e.jsx(m,{size:12,children:e.jsxs(u,{value:v,label:"Type",onChange:B,name:"collection_type",required:!0,select:!0,fullWidth:!0,margin:"dense",variant:"outlined",style:{marginTop:"1.5rem",marginBottom:"0.5rem"},children:[e.jsx(l,{value:"category",children:"Category"}),e.jsx(l,{value:"brand",children:"Brand"}),e.jsx(l,{value:"tag",children:"Tag"})]})}),v==="category"&&e.jsx(m,{size:12,children:e.jsxs(u,{value:T,label:"Parent Collection (Optional)",onChange:t=>p(t.target.value),name:"parent_id",select:!0,fullWidth:!0,margin:"dense",variant:"outlined",style:{marginTop:"1.5rem",marginBottom:"0.5rem"},children:[e.jsx(l,{value:"",children:e.jsx("em",{className:"text-gray-500",children:"None (Root Level)"})}),_.map(t=>e.jsx(l,{value:t.id,children:e.jsxs("span",{className:`pl-${t.level*4}`,children:[t.level>0&&"└─ ",t.name]})},t.id))]})}),e.jsx(m,{size:12,children:e.jsx(u,{margin:"dense",name:"description",label:"Description",type:"text",fullWidth:!0,variant:"outlined",value:S,onChange:t=>x(t.target.value)})})]})}),e.jsxs(W,{children:[e.jsx(C,{onClick:d,children:"Cancel"}),e.jsx(C,{type:"submit",children:"SAVE"})]})]})})}export{Oe as default};
