import{r as g,d as E,g as W,j as e,R as Y,b as I}from"./currencyStore-Dk9RVyyc.js";import{C as M}from"./Close-B9rgBTOR.js";import{S as j}from"./sweetalert2.esm.all-q958Q1qq.js";import{D as R,a as q}from"./DialogContent-Cz4a0t2H.js";import{D as w}from"./DialogTitle-osZsMdGC.js";import{I as z}from"./IconButton-PbvyX_sG.js";import{G as u}from"./Grid-6qcTmjc4.js";import{T as m}from"./TextField-DpXyhoD7.js";import{I as N}from"./InputAdornment-DZOHCUsF.js";import{M as o}from"./MenuItem-CEIQJ6q4.js";import{D as k}from"./Divider-D4ysiqwk.js";import{D as T}from"./DialogActions-BraO_KzF.js";import{B as C}from"./Button-aMjmD1gp.js";const b={amount:0,payment_method:"Cash",transaction_date:E().format("YYYY-MM-DD"),note:"",store_id:1};function ae({open:y,setOpen:D,selectedContact:v,selectedTransaction:n=null,amountLimit:s,is_customer:_=!1,stores:A=null,refreshTable:S}){const[i,p]=g.useState(!1),[t,x]=g.useState(b),B=W(a=>a.settings.currency_symbol),F=()=>i?"Loading...":t.payment_method==="Cash"||t.payment_method==="Cheque"?t.amount<0?"REFUND":"PAY":t.payment_method==="Account Balance"?t.amount<0?"CREDIT":"UPDATE BALANCE":"ADD PAYMENT",c=()=>{x(b),D(!1)},l=a=>{const{name:h,value:r}=a.target;x({...t,[h]:r})},P=a=>{if(a.preventDefault(),i)return;p(!0);const h=new FormData(a.currentTarget);let r=Object.fromEntries(h.entries());r.contact_id=v,a.nativeEvent.submitter.name=="credit"&&(r.amount=-Math.abs(t.amount)),n!==null&&(r.transaction_id=n.id,r.store_id=n.store_id);let f="/customer-transaction";_||(f="/vendor-transaction"),I.post(f,r).then(d=>{j.fire({title:"Success!",text:d.data.message,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),S(window.location.pathname),c()}).catch(d=>{j.fire({title:"Failed!",text:d.response.data.error,icon:"error",showConfirmButton:!0}),console.log(d)}).finally(()=>{p(!1)})};return e.jsx(Y.Fragment,{children:e.jsxs(R,{fullWidth:!0,maxWidth:"sm",open:y,onClose:c,"aria-labelledby":"alert-dialog-title",PaperProps:{component:"form",onSubmit:P},children:[e.jsx(w,{id:"alert-dialog-title",children:"ADD PAYMENTS"}),e.jsx(z,{"aria-label":"close",onClick:c,sx:a=>({position:"absolute",right:8,top:8,color:a.palette.grey[500]}),children:e.jsx(M,{})}),e.jsxs(q,{children:[e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{size:{xs:12,sm:4},children:e.jsx(m,{fullWidth:!0,type:"number",name:"amount",label:"Amount",variant:"outlined",autoFocus:!0,sx:{input:{fontWeight:"bold"}},value:t.amount,onChange:l,onFocus:a=>{a.target.select()},slotProps:{inputLabel:{shrink:!0},input:{startAdornment:e.jsx(N,{position:"start",children:B})}}})}),e.jsx(u,{size:{xs:12,sm:4},children:e.jsxs(m,{name:"payment_method",value:t.payment_method,onChange:l,label:"Payment Method",select:!0,fullWidth:!0,children:[e.jsx(o,{value:"Cash",children:"Cash"}),e.jsx(o,{value:"Cheque",children:"Cheque"}),e.jsx(o,{value:"Card",children:"Card"}),e.jsx(o,{value:"Bank",children:"Bank"}),n===null&&e.jsx(o,{value:"Account Balance",children:"Account Balance"}),n!==null&&e.jsx(o,{value:"Account",children:"Account"})]})}),e.jsx(u,{size:{xs:12,sm:4},children:e.jsx(m,{label:"Date",name:"transaction_date",fullWidth:!0,type:"date",slotProps:{inputLabel:{shrink:!0}},value:t.transaction_date,onChange:l,required:!0})}),(n===null||s===void 0)&&e.jsx(u,{size:{xs:12,sm:12},children:e.jsx(m,{value:t.store_id,label:"Store",onChange:l,required:!0,name:"store_id",select:!0,fullWidth:!0,children:A?.map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))})})]}),e.jsx(k,{sx:{py:"0.5rem"}}),e.jsx(m,{fullWidth:!0,variant:"outlined",label:"Note",name:"note",multiline:!0,sx:{mt:"1rem"},value:t.note,onChange:l})]}),e.jsxs(T,{children:[e.jsx(C,{variant:"contained",fullWidth:!0,sx:{paddingY:"15px",fontSize:"1.5rem"},type:"submit",color:t.amount<0?"error":"primary",disabled:t.amount==0||s!==void 0&&t.amount>s||i,children:F()}),n===null&&t.amount>=0&&e.jsx(C,{variant:"contained",fullWidth:!0,sx:{paddingY:"15px",fontSize:"1.5rem"},type:"submit",color:"error",name:"credit",value:"credit",disabled:t.amount==0||s!==void 0&&t.amount>s||i,children:i?"Loading...":t.payment_method==="Cash"||t.payment_method==="Cheque"?"REFUND":"CREDIT"})]})]})})}export{ae as A};
